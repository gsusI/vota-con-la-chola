(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18439,e=>{"use strict";var s=e.i(43476),a=e.i(71645);function t(){return"/vota-con-la-chola"}function r(e){return null==e||Number.isNaN(Number(e))?"0":Number(e).toLocaleString("es-ES")}function l(e){return String(e||"").split("|").map(e=>e.trim()).filter(Boolean)}function i(e){let s=Number(e);return Number.isFinite(s)?s:0}function n(){let{loading:e,error:n,data:o}=function(){let[e,s]=(0,a.useState)({loading:!0,error:null,data:null});return(0,a.useEffect)(()=>{let e=new AbortController;return fetch(`${t()}/people/data/profiles.json`,{signal:e.signal}).then(e=>{if(!e.ok)throw Error(`Respuesta no v\xe1lida: ${e.status}`);return e.json()}).then(e=>{s({loading:!1,error:null,data:e})}).catch(e=>{"AbortError"!==e.name&&s({loading:!1,error:e.message||String(e),data:null})}),()=>e.abort()},[]),e}(),[c,d]=(0,a.useState)("top"),[h,u]=(0,a.useState)(""),[p,m]=(0,a.useState)("all"),[x,j]=(0,a.useState)(250),[b,g]=(0,a.useState)(0);(0,a.useEffect)(()=>{let e,s,a,t=(s=Number((e=new URL(window.location.href)).searchParams.get("person_id")||0),a=String(e.searchParams.get("bucket")||"").trim().toUpperCase(),{personId:Number.isFinite(s)?s:0,bucket:a});t.personId>0&&g(t.personId),t.bucket&&d("TOP"===t.bucket?"top":t.bucket)},[]);let v=(0,a.useMemo)(()=>{let e=new Map;for(let s of o?.buckets||[])e.set(String(s.bucket||"").toUpperCase(),s.file);return e},[o]),N=(0,a.useMemo)(()=>o?"top"===c?String(o.top?.file||""):v.get(String(c||"").toUpperCase())||String(o.top?.file||""):"",[c,v,o]),{loading:_,error:f,data:S}=function(e){let[s,r]=(0,a.useState)({loading:!0,error:null,data:null,filePath:""});return(0,a.useEffect)(()=>{if(!e)return void r({loading:!1,error:null,data:null,filePath:""});let s=new AbortController,a=`${t()}/people/data/${e}`;return r(s=>({...s,loading:!0,error:null,filePath:e})),fetch(a,{signal:s.signal}).then(e=>{if(!e.ok)throw Error(`Respuesta no v\xe1lida: ${e.status}`);return e.json()}).then(s=>{r({loading:!1,error:null,data:s,filePath:e})}).catch(s=>{"AbortError"!==s.name&&r({loading:!1,error:s.message||String(s),data:null,filePath:e})}),()=>s.abort()},[e]),s}(N),T=S?.columns||o?.columns||[],y=S?.rows||[],k=(0,a.useMemo)(()=>(function(e){let s={};for(let a=0;a<e.length;a+=1)s[e[a]]=a;return(e,a)=>e?.[s[a]]})(T),[T]),w=(0,a.useMemo)(()=>y.length&&T.length?function(e,s,a,t,r){let l=String(a||"").trim().toLowerCase(),n=Math.max(20,Number(r)||250),o=[],c=0;for(let a of e){let e=i(s(a,"queue_pending_total")),r=i(s(a,"queue_in_progress_total")),d=i(s(a,"active_mandates")),h=i(s(a,"votes_total"));if(("queue"!==t||!(e+r<=0))&&("active"!==t||!(d<=0))&&("votes"!==t||!(h<=0))){if(l&&![s(a,"full_name"),s(a,"canonical_key"),s(a,"territory_name"),s(a,"roles_ever"),s(a,"parties_ever")].map(e=>String(e||"")).join(" ").toLowerCase().includes(l))continue;c+=1,o.length<n&&o.push(a)}}return{shown:o,total:c}}(y,k,h,p,x):{shown:[],total:0},[y,T,k,h,p,x]),C=(0,a.useMemo)(()=>{let e=new Map;for(let s of y){let a=i(k(s,"person_id"));a>0&&e.set(a,s)}return e},[y,k]),E=(0,a.useMemo)(()=>b>0&&C.has(b)?C.get(b):w.shown[0]||null,[b,C,w.shown]);(0,a.useEffect)(()=>{if(!E)return;let e=i(k(E,"person_id"));e<=0||e!==b&&g(e)},[E,b,k]),(0,a.useEffect)(()=>{let e=new URL(window.location.href);b>0?e.searchParams.set("person_id",String(b)):e.searchParams.delete("person_id"),c&&"top"!==c?e.searchParams.set("bucket",String(c).toUpperCase()):e.searchParams.delete("bucket"),window.history.replaceState({},"",e.toString())},[b,c]);let P=(0,a.useMemo)(()=>{if(!E)return null;let e=i(k(E,"person_id")),s=function(e,s){let a=String(s(e,"positions_ever_json")||"[]");if(!a)return[];try{let e=JSON.parse(a);return Array.isArray(e)?e:[]}catch{return[]}}(E,k),a=i(k(E,"queue_pending_total")),t=i(k(E,"queue_in_progress_total"));return{personId:e,fullName:String(k(E,"full_name")||""),canonicalKey:String(k(E,"canonical_key")||""),birthDate:String(k(E,"birth_date")||""),genderLabel:String(k(E,"gender_label")||""),territoryName:String(k(E,"territory_name")||""),mandatesTotal:i(k(E,"mandates_total")),activeMandates:i(k(E,"active_mandates")),institutionsTotal:i(k(E,"institutions_total")),partiesTotal:i(k(E,"parties_total")),votesTotal:i(k(E,"votes_total")),voteEventsTotal:i(k(E,"vote_events_total")),declaredEvidenceTotal:i(k(E,"declared_evidence_total")),revealedVoteEvidenceTotal:i(k(E,"revealed_vote_evidence_total")),topicPositionsTotal:i(k(E,"topic_positions_total")),aliasesTotal:i(k(E,"aliases_total")),identifiersTotal:i(k(E,"identifiers_total")),firstMandateStart:String(k(E,"first_mandate_start")||""),lastMandateDate:String(k(E,"last_mandate_date")||""),lastVoteDate:String(k(E,"last_vote_date")||""),lastEvidenceDate:String(k(E,"last_evidence_date")||""),lastActionDate:String(k(E,"last_action_date")||""),rolesEver:l(k(E,"roles_ever")),institutionsEver:l(k(E,"institutions_ever")),partiesEver:l(k(E,"parties_ever")),queuePendingTotal:a,queueInProgressTotal:t,queueOpenTotal:a+t,queuePriorityMax:i(k(E,"queue_priority_max")),queueGapCodes:l(k(E,"queue_gap_codes")),queueNextActions:l(k(E,"queue_next_actions")),positions:s}},[E,k]),q=(0,a.useMemo)(()=>{let e=[{value:"top",label:`Top (${r(o?.top?.rows_total||0)})`}];for(let s of o?.buckets||[])e.push({value:String(s.bucket||"").toUpperCase(),label:`${String(s.bucket||"").toUpperCase()} (${r(s.rows_total||0)})`});return e},[o]);if(e)return(0,s.jsx)("main",{className:"shell",children:(0,s.jsx)("section",{className:"card block",children:(0,s.jsx)("p",{className:"sub",children:"Cargando directorio de personas…"})})});if(n||!o)return(0,s.jsx)("main",{className:"shell",children:(0,s.jsxs)("section",{className:"card block",children:[(0,s.jsx)("h2",{children:"Directorio no disponible"}),(0,s.jsx)("p",{className:"sub",children:"No pude cargar el manifiesto estático de perfiles."}),(0,s.jsxs)("p",{className:"sub",children:["Error: ",n||"sin datos"]}),(0,s.jsxs)("p",{className:"sub",children:["Asegura regenerar ",(0,s.jsx)("code",{children:"docs/gh-pages/people/data/profiles.json"})," con"," ",(0,s.jsx)("code",{children:"just explorer-gh-pages-build"})," o con"," ",(0,s.jsx)("code",{children:"GH_PAGES_NEXT_PRIME_EXPORT=1 just gh-pages-next"}),"."]})]})});let M=`${t()}/explorer/`;return(0,s.jsxs)("main",{className:"shell",children:[(0,s.jsxs)("section",{className:"hero card",children:[(0,s.jsx)("p",{className:"eyebrow",children:"Directory + Xray"}),(0,s.jsx)("h1",{children:"Personas y trayectoria pública"}),(0,s.jsx)("p",{className:"sub",children:"Directorio navegable de personas con resumen de actividad, posiciones que han ocupado y cola de datos públicos faltantes."}),(0,s.jsxs)("div",{className:"chips",children:[(0,s.jsxs)("span",{className:"chip",children:["Snapshot: ",o.meta?.snapshot_date||"—"]}),(0,s.jsxs)("span",{className:"chip",children:["Personas: ",r(o.meta?.people_total||0)]}),(0,s.jsxs)("span",{className:"chip",children:["Buckets: ",r((o.buckets||[]).length)]})]})]}),(0,s.jsxs)("section",{className:"card block",children:[(0,s.jsx)("div",{className:"blockHead",children:(0,s.jsx)("h2",{children:"Directorio"})}),(0,s.jsx)("p",{className:"sub",children:"Carga inicial con top; para buscar en todo el padrón usa bucket por inicial."}),(0,s.jsxs)("div",{className:"filterGrid",children:[(0,s.jsxs)("label",{className:"field",children:["Bucket",(0,s.jsx)("select",{value:c,onChange:e=>d(e.target.value),children:q.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,s.jsxs)("label",{className:"field",children:["Modo",(0,s.jsxs)("select",{value:p,onChange:e=>m(e.target.value),children:[(0,s.jsx)("option",{value:"all",children:"Todos"}),(0,s.jsx)("option",{value:"queue",children:"Con cola abierta"}),(0,s.jsx)("option",{value:"active",children:"Con mandato activo"}),(0,s.jsx)("option",{value:"votes",children:"Con votos registrados"})]})]}),(0,s.jsxs)("label",{className:"field",children:["Máx. filas en tabla",(0,s.jsxs)("select",{value:x,onChange:e=>j(Number(e.target.value)||250),children:[(0,s.jsx)("option",{value:100,children:"100"}),(0,s.jsx)("option",{value:250,children:"250"}),(0,s.jsx)("option",{value:500,children:"500"}),(0,s.jsx)("option",{value:1e3,children:"1000"})]})]}),(0,s.jsxs)("label",{className:"field",children:["Buscar",(0,s.jsx)("input",{className:"textInput",type:"search",placeholder:"Nombre, clave, territorio, rol, partido",value:h,onChange:e=>u(e.target.value)})]})]}),(0,s.jsxs)("div",{className:"chips",style:{marginTop:10},children:[(0,s.jsxs)("span",{className:"chip",children:["Coincidencias: ",r(w.total)]}),(0,s.jsxs)("span",{className:"chip",children:["Mostrando: ",r(w.shown.length)]}),(0,s.jsxs)("span",{className:"chip",children:["Archivo: ",N||"—"]})]}),_?(0,s.jsx)("p",{className:"sub",style:{marginTop:10},children:"Cargando filas del bucket…"}):null,f?(0,s.jsxs)("p",{className:"sub",style:{marginTop:10},children:["Error de bucket: ",f]}):null,(0,s.jsx)("div",{className:"tableWrap",children:(0,s.jsxs)("table",{className:"table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Persona"}),(0,s.jsx)("th",{children:"Territorio"}),(0,s.jsx)("th",{children:"Mandatos activos"}),(0,s.jsx)("th",{children:"Votos"}),(0,s.jsx)("th",{children:"Última acción"}),(0,s.jsx)("th",{children:"Cola abierta"})]})}),(0,s.jsx)("tbody",{children:w.shown.map(e=>{let a=i(k(e,"person_id")),t=i(k(e,"queue_pending_total"))+i(k(e,"queue_in_progress_total")),l=P?.personId===a;return(0,s.jsxs)("tr",{className:l?"rowSelected":"",children:[(0,s.jsx)("td",{children:(0,s.jsx)("button",{className:"tableButton",onClick:()=>g(a),children:String(k(e,"full_name")||`Persona ${a}`)})}),(0,s.jsx)("td",{children:String(k(e,"territory_name")||"—")}),(0,s.jsx)("td",{children:r(k(e,"active_mandates"))}),(0,s.jsx)("td",{children:r(k(e,"votes_total"))}),(0,s.jsx)("td",{children:String(k(e,"last_action_date")||"—")}),(0,s.jsx)("td",{children:r(t)})]},a)})})]})})]}),(0,s.jsxs)("section",{className:"card block",children:[(0,s.jsx)("div",{className:"blockHead",children:(0,s.jsx)("h2",{children:"Perfil seleccionado"})}),P?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{style:{margin:"8px 0 4px"},children:P.fullName}),(0,s.jsxs)("p",{className:"sub",children:["Clave canónica: ",(0,s.jsx)("code",{children:P.canonicalKey||"—"})]}),(0,s.jsxs)("div",{className:"chips",children:[(0,s.jsxs)("span",{className:"chip",children:["Mandatos: ",r(P.mandatesTotal)]}),(0,s.jsxs)("span",{className:"chip",children:["Activos: ",r(P.activeMandates)]}),(0,s.jsxs)("span",{className:"chip",children:["Votos: ",r(P.votesTotal)]}),(0,s.jsxs)("span",{className:"chip",children:["Cola abierta: ",r(P.queueOpenTotal)]})]}),(0,s.jsxs)("div",{className:"twoCols",style:{marginTop:12},children:[(0,s.jsxs)("article",{className:"kpiCard",children:[(0,s.jsx)("span",{className:"kpiLabel",children:"Identidad"}),(0,s.jsxs)("p",{className:"sub",children:["Nacimiento: ",P.birthDate||"—"]}),(0,s.jsxs)("p",{className:"sub",children:["Género: ",P.genderLabel||"—"]}),(0,s.jsxs)("p",{className:"sub",children:["Territorio: ",P.territoryName||"—"]}),(0,s.jsxs)("p",{className:"sub",children:["Identificadores: ",r(P.identifiersTotal)]}),(0,s.jsxs)("p",{className:"sub",children:["Alias: ",r(P.aliasesTotal)]})]}),(0,s.jsxs)("article",{className:"kpiCard",children:[(0,s.jsx)("span",{className:"kpiLabel",children:"Actividad"}),(0,s.jsxs)("p",{className:"sub",children:["Instituciones: ",r(P.institutionsTotal)]}),(0,s.jsxs)("p",{className:"sub",children:["Partidos: ",r(P.partiesTotal)]}),(0,s.jsxs)("p",{className:"sub",children:["Eventos de voto: ",r(P.voteEventsTotal)]}),(0,s.jsxs)("p",{className:"sub",children:["Evidencia declarada: ",r(P.declaredEvidenceTotal)]}),(0,s.jsxs)("p",{className:"sub",children:["Posiciones temáticas: ",r(P.topicPositionsTotal)]})]})]}),(0,s.jsxs)("div",{className:"twoCols",style:{marginTop:12},children:[(0,s.jsxs)("article",{className:"kpiCard",children:[(0,s.jsx)("span",{className:"kpiLabel",children:"Ventana temporal"}),(0,s.jsxs)("p",{className:"sub",children:["Primer mandato: ",P.firstMandateStart||"—"]}),(0,s.jsxs)("p",{className:"sub",children:["Último mandato: ",P.lastMandateDate||"—"]}),(0,s.jsxs)("p",{className:"sub",children:["Último voto: ",P.lastVoteDate||"—"]}),(0,s.jsxs)("p",{className:"sub",children:["Última evidencia: ",P.lastEvidenceDate||"—"]}),(0,s.jsxs)("p",{className:"sub",children:["Última acción: ",P.lastActionDate||"—"]})]}),(0,s.jsxs)("article",{className:"kpiCard",children:[(0,s.jsx)("span",{className:"kpiLabel",children:"Datos faltantes públicos"}),(0,s.jsxs)("p",{className:"sub",children:["Pendientes: ",r(P.queuePendingTotal)]}),(0,s.jsxs)("p",{className:"sub",children:["En progreso: ",r(P.queueInProgressTotal)]}),(0,s.jsxs)("p",{className:"sub",children:["Prioridad max: ",r(P.queuePriorityMax)]}),(0,s.jsxs)("p",{className:"sub",children:["Gaps: ",P.queueGapCodes.length?P.queueGapCodes.join(", "):"—"]}),(0,s.jsxs)("p",{className:"sub",children:["Siguiente acción: ",P.queueNextActions.length?P.queueNextActions.join(", "):"—"]})]})]}),(0,s.jsxs)("div",{style:{marginTop:12},children:[(0,s.jsx)("h3",{style:{margin:"0 0 8px"},children:"Posiciones que ha ocupado"}),P.positions.length?(0,s.jsx)("div",{className:"tableWrap",children:(0,s.jsxs)("table",{className:"table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Cargo"}),(0,s.jsx)("th",{children:"Institución"}),(0,s.jsx)("th",{children:"Partido"}),(0,s.jsx)("th",{children:"Ámbito"}),(0,s.jsx)("th",{children:"Territorio"}),(0,s.jsx)("th",{children:"Inicio"}),(0,s.jsx)("th",{children:"Fin"}),(0,s.jsx)("th",{children:"Activo"})]})}),(0,s.jsx)("tbody",{children:P.positions.map((e,a)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.role_title||"—"}),(0,s.jsx)("td",{children:e.institution_name||"—"}),(0,s.jsx)("td",{children:e.party||"—"}),(0,s.jsx)("td",{children:e.admin_level||"—"}),(0,s.jsx)("td",{children:e.territory_name||"—"}),(0,s.jsx)("td",{children:e.first_start_date||"—"}),(0,s.jsx)("td",{children:e.last_end_date||"—"}),(0,s.jsx)("td",{children:e.currently_active?"sí":"no"})]},`${P.personId}-${a}`))})]})}):(0,s.jsx)("p",{className:"sub",children:"Sin posiciones históricas registradas en el snapshot."})]}),(0,s.jsxs)("div",{style:{marginTop:12},children:[(0,s.jsx)("h3",{style:{margin:"0 0 8px"},children:"Listas rápidas"}),(0,s.jsxs)("div",{className:"profileTags",children:[P.rolesEver.map(e=>(0,s.jsx)("span",{className:"chip",children:e},`role-${e}`)),P.institutionsEver.map(e=>(0,s.jsx)("span",{className:"chip",children:e},`institution-${e}`)),P.partiesEver.map(e=>(0,s.jsx)("span",{className:"chip",children:e},`party-${e}`))]})]}),(0,s.jsxs)("ul",{className:"artifactList",style:{marginTop:12},children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("a",{href:`${M}?t=mandates&wc=person_id&wv=${P.personId}`,children:"Explorer: mandatos"}),(0,s.jsx)("span",{children:"drill-down directo"})]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("a",{href:`${M}?t=parl_vote_member_votes&wc=person_id&wv=${P.personId}`,children:"Explorer: votos persona"}),(0,s.jsx)("span",{children:"histórico de voto"})]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("a",{href:`${M}?t=topic_evidence&wc=person_id&wv=${P.personId}`,children:"Explorer: evidencia temática"}),(0,s.jsx)("span",{children:"trazabilidad de postura"})]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("a",{href:`${M}?t=person_public_data_queue&wc=person_id&wv=${P.personId}`,children:"Explorer: cola de datos faltantes"}),(0,s.jsx)("span",{children:"backlog por persona"})]})]})]}):(0,s.jsx)("p",{className:"sub",children:"Selecciona una persona para ver su xray."})]})]})}e.s(["default",()=>n])}]);