# Roadmap técnico

Nota:
- Visión macro y marco "acción revelada + impacto": `docs/roadmap.md`.
- Este documento se centra en la ejecución de corto plazo para cerrar el loop "dicen/hacen", fiabilidad y recomendación con trazabilidad.
- Estimación de esfuerzo en puntos (misma escala que `docs/roadmap.md`).
- Backlog operativo + estado real: `docs/etl/e2e-scrape-load-tracker.md` y dashboard `/explorer-sources`.

## Alineación visión/misión

- Visión (canónica en `docs/roadmap.md`): decidir el voto comparando promesa, ejecución e impacto con evidencia verificable por nivel territorial.
- Misión operativa de este roadmap técnico: convertir esa visión en una cadena reproducible de ejecución (`ingesta -> evidencia -> posiciones -> fiabilidad -> publicación`) con trazabilidad extremo a extremo.

## 1) Objetivo del roadmap

Entregar una versión técnica robusta de Vota Con La Chola que permita:
- Expresar preferencias del usuario.
- Comparar esas preferencias con posiciones públicas y trazables.
- Calcular fiabilidad por actor y tema con evidencia verificable.
- Publicar resultados reproducibles por snapshot.
- Mantener distribución pública gratuita de snapshots en Hugging Face para colaboración externa.
- Mantener trazabilidad completa por defecto en SQLite y en JSON publicado.

## 2) Estado base actual

Componentes ya operativos:
- ETL de representantes y mandatos a un único SQLite.
- Ingesta de múltiples fuentes de cargos públicos con idempotencia `(source_id, source_record_id)`.
- Ingesta de votaciones/iniciativas de Congreso y Senado.
- Cargas y publicación de snapshots (`representantes-es-<snapshot>.json` y `votaciones-es-<snapshot>.json`).
- UI de grafo y explorador SQLite con navegación por esquema y FKs.

Brechas críticas pendientes:
- Relación sólida entre votos/iniciativas y “posiciones públicas”.
- Modelo de recomendación explicable para usuario final.
- Capa de confiabilidad con incertidumbre (y señales de cobertura).
- Cobertura multinivel estable para voto útil más allá de nacional.
- Cobertura holística de “acciones” fuera del parlamento: normativa (BOE), acción ejecutiva (Consejo de Ministros), dinero público (contratación PLACSP, subvenciones BDNS) y transparencia (agendas/declaraciones) con trazabilidad.

## 3) Arquitectura objetivo (corto alcance)

Mantener el monolito ultra-lean y avanzar por capas:
- `Ingesta -> Normalización -> Enriquecimiento -> KPIs -> Publicación -> API -> UI`
- Una sola base SQLite de operación.
- Una sola forma de snapshot canónico por fecha.
- Backend mínimo en Python sin agregar frameworks pesados.

## 4) Roadmap por fases

### Fase 0 — Reforzar base de datos y calidad (`ENG: 8`)

Entregables:
- Endurecer esquema para evidencias textuales sin romper compatibilidad.
- Consolidar identidad de personas: `persons` + `person_identifiers` + normalización de nombres.
- Consolidar analítica por temas: `topic_sets`, `topics`, `topic_evidence`, `topic_positions` (seed/versionado: `etl/data/seeds/topic_taxonomy_es.json`).
- Añadir índices recomendados para joins frecuentes.
- Ajustar `scripts/publicar_votaciones_es.py` para incluir campos de calidad por fila.
- Cerrar contrato de calidad con `--enforce-gate` para fuentes críticas.

Criterios de salida:
- `quality-report` de votaciones con `--enforce-gate` en verde en entorno CI local.
- `PRAGMA foreign_key_check` sin errores.
- KPIs mínimos en verde para fuentes `DONE` (ver `docs/etl/e2e-scrape-load-tracker.md`).

### Fase 1 — Cerrar loop de “lo que hacen” (`ENG: 8`)

Entregables:
- Finalizar cobertura nacional reproducible de votaciones con linking estable a iniciativa/tema.
- Materializar “qué se votó”: descargar y mapear documentos de iniciativa (BOCG / Diario de Sesiones) y exponerlos como evidencia navegable.
- Publicación periódica del snapshot de votaciones + KPIs.
- Resolver `person_id` en máximo volumen posible en votos nominales.
- Añadir auditoría de causa de no-mapeo con muestra revisable.
- Definir “doble entrada” para acciones: señales comunicacionales (ej. referencias del Consejo de Ministros) deben validarse contra registros con efectos (ej. BOE) cuando exista correspondencia.
- Cortar normativa en unidades auditables (artículos/disposiciones/anexos) para no tratar leyes omnibus como bloque único.

Métricas de aceptación:
- `>= 95%` eventos con fecha.
- `>= 95%` eventos con iniciativa enlazada (permitir `derived` cuando el catálogo oficial sea incompleto).
- `>= 90%` votos nominales con `person_id` cuando exista censo disponible.
- Seguimiento visible de `latest_events_with_topic_evidence_pct` (eventos de la legislatura activa presentes en `topic_evidence`).
- Trazabilidad completa: cada registro publicado con `source_id` y `source_url`.

### Fase 2 — Posiciones públicas y señal de coherencia (`ENG: 13`)

Entregables:
- Pipeline mínimo para textos programáticos/declarativos (programas, comunicados, propuestas).
- Extracción de claims con actor, tema, postura, evidencia textual y confianza base por fuente.
- Capa de normalización de postura: `a favor`, `en contra`, `mixta`, `incierta`.
- Unión de claims + votos en la misma ontología de temas.

Controles:
- `% rows con source_url y source_hash = 100%` para contenido publicado.
- Regla de revisión humana (`low_confidence` y cambios de tópico ambiguo).

### Fase 3 — Motor de recomendación y fiabilidad (`ENG: 13`)

Entregables:
- `POST /api/recommendation/run` (local o CLI equivalente) que reciba preferencias, pesos social/personal y circunscripción/ámbito.
- Score de alineación por actor con explicación por tema.
- Score de fiabilidad por actor y tema con incertidumbre (conservador con pocas muestras).
- Vistas: “alineación”, “evidencia”, “vacíos de evidencia”.

Modelo de base:
- Alineación = suma ponderada de coincidencia tema-postura.
- Fiabilidad = función de consistencia voto-habla y consistencia temporal de comportamiento.
- Presentar siempre `count` y nivel de confianza, no solo numeritos.

### Fase 4 — UX + comunidad + operaciones (`ENG: 8`)

Entregables:
- Onboarding de preferencias en 60 segundos.
- Matriz final actor/partido por alineación y evidencia verificable.
- Página de “cómo se calculó” con links a evidencias.
- Integración de revisión comunitaria de claims (PR + checklist 2ª mirada).
- Pipeline de publicación canónica para `topics.json`, `claims.json`, `recommendation-kpis.json`.
- Pipeline de publicación externa por snapshot en Hugging Face (`just etl-publish-hf`) con `manifest.json` y `checksums.sha256`.

### Fase 5 — Cobertura multinivel (`ENG: 21+`)

Prioridad por impacto:
- Electoralmente: CCAA y municipal donde haya fuente reproducible.
- UE: votaciones/roll-call en formato usable para voto-nominal.
- Información territorial: mapa de competencias.
- Ajuste de recomendaciones por nivel con mismo formato de scores.

## 5) Gestión técnica de riesgos

Riesgo de red anti-bot:
- Mantener modo manual con evidencia reproducible por snapshots `--from-file`.
- Documentar fallback y estado en `ingestion_runs.message`.

Riesgo de sesgo metodológico:
- Publicar metodología, pesos y fuentes antes de cada release.
- Separar evidencia declarativa de evidencia de voto y mostrar cobertura por tema.

Riesgo de legalidad y privacidad:
- Evitar persistir preferencias sensibles en servidor por defecto.
- Minimizar datos personales; priorizar cómputo local cuando sea viable.

## 6) KPIs de programa

- Cobertura de tracking: fuentes críticas en estado `ok` en ejecución e2e.
- Cobertura política: eventos con iniciativa enlazada; % votos nominales con persona resuelta; % evidencia con `topic_id`.
- Productividad: tiempo de `etl` por snapshot; costo de reintentos por fuente.
- Calidad de recomendación: porcentaje de temas con evidencia suficiente; tasa de cambios en recomendaciones tras nueva evidencia.

## 7) Próximo paso operativo

`MILESTONE-1` (cerrar `Fase 0` + dejar encaminada `Fase 1`):

Hecho:
- Pipeline reproducible de votaciones con gate + KPIs: `just parl-publish-votaciones`.
- Baseline operativo en tracker: `docs/etl/e2e-scrape-load-tracker.md` + dashboard `/explorer-sources`.
- Slice AI-OPS-115 (normativa/accountability sancionadora): base de tablas `legal_norms/legal_norm_fragments/legal_fragment_responsibilities/sanction_norm_catalog/sanction_norm_fragment_links`, semilla cerrada `sanction_norms_seed_v1.json`, scripts operativos (`validate/import/report`) y pipeline reproducible `just parl-sanction-norms-seed-pipeline` con evidencia en `docs/etl/sprints/AI-OPS-115/reports/sanction-norms-seed-lane.md`.
- Slice AI-OPS-116 (datos sancionadores): catálogo de fuentes `sanction_volume_sources` (5 lanes), tipologías `sanction_infraction_types` + mappings iniciales a `norma_fragmento`, y contrato KPI garantista `sanction_procedural_kpi_definitions`, con pipeline reproducible `just parl-sanction-data-catalog-pipeline` y evidencia en `docs/etl/sprints/AI-OPS-116/reports/sanction-data-catalog-lane.md`.
- Slice AI-OPS-117 (ranking+dossiers+municipal piloto): carga reproducible `sanction_volume_pilot_seed_v1` sobre `sanction_volume_observations/sanction_procedural_metrics/sanction_municipal_ordinances/sanction_municipal_ordinance_fragments`, reporte operativo `report_sanction_volume_pilot_status.py` (`top_normas_sancion_ciudadana` + `norm_dossiers`) y pipeline `just parl-sanction-citizen-pilot-pipeline` con evidencia en `docs/etl/sprints/AI-OPS-117/reports/sanction-volume-pilot-lane.md`.
- Slice AI-OPS-118 (derechos/IRLC base): contrato reproducible de restricciones (`liberty_irlc_methodologies/liberty_right_categories/liberty_restriction_assessments`), semilla cerrada `liberty_restrictions_seed_v1.json`, reporte de cobertura+gate `report_liberty_restrictions_status.py` y export snapshot inicial `export_liberty_restrictions_snapshot.py` bajo `just parl-liberty-restrictions-pipeline`, con evidencia en `docs/etl/sprints/AI-OPS-118/reports/liberty-restrictions-foundation-lane.md`.
- Slice AI-OPS-119 (derechos/proporcionalidad + atribucion directa): contrato reproducible `liberty_proportionality_methodologies/liberty_proportionality_reviews`, gate operativo de proporcionalidad (`just parl-check-liberty-proportionality-gate`), scoring de atribucion directa (`report_liberty_direct_accountability_scores.py`) y snapshot extendido con `proportionality_reviews` + `accountability_scores`, con evidencia en `docs/etl/sprints/AI-OPS-119/reports/liberty-proportionality-direct-accountability-lane.md`.
- Slice AI-OPS-120 (derechos/arbitrariedad territorial + cadena indirecta): lane de enforcement territorial (`liberty_enforcement_methodologies/liberty_enforcement_observations`) con gate de cobertura multi-territorio, lane causal indirecta (`liberty_indirect_methodologies/liberty_indirect_responsibility_edges`) con filtros `causal_distance/edge_confidence` y anti-sobreatribucion, y snapshot extendido con `enforcement_variation` + `indirect_accountability_summary`, con evidencia en `docs/etl/sprints/AI-OPS-120/reports/liberty-territorial-variation-indirect-accountability-lane.md`.
- Slice AI-OPS-121 (derechos/regulación delegada y enforcement): lane reproducible `norma_habilitante -> organismo delegado -> cargo designado -> acto de enforcement` con `liberty_delegated_enforcement_methodologies/liberty_delegated_enforcement_links`, gate operativo de cobertura (`designated_actor` + `enforcement_evidence`) en `report_liberty_delegated_enforcement_status.py`, y snapshot extendido con `delegated_enforcement_links` + `delegated_enforcement_summary`, con evidencia en `docs/etl/sprints/AI-OPS-121/reports/liberty-delegated-enforcement-lane.md`.
- Slice AI-OPS-122 (derechos/focus gate en CI): política de bloqueo automática conectada al gate `just parl-check-liberty-focus-gate` mediante job `liberty-focus-gate-contract` en `.github/workflows/etl-tracker-gate.yml`, con contrato fail/pass (`exit=2` en umbral imposible y pass estricto en umbrales operativos) y artifacts de evidencia en `docs/etl/sprints/AI-OPS-122/reports/liberty-focus-gate-ci-policy.md`.
- Slice AI-OPS-123 (derechos/cobertura refresh): rutina periódica reproducible para KPIs de cobertura con heartbeat append-only (`report_liberty_restrictions_status_heartbeat.py`) + ventana estricta (`report_liberty_restrictions_status_heartbeat_window.py`), integrada en `just` (`parl-report-liberty-restrictions-status-heartbeat`, `parl-check-liberty-restrictions-status-heartbeat-window`), `parl-liberty-restrictions-pipeline` y job CI `liberty-focus-gate-contract`, con evidencia en `docs/etl/sprints/AI-OPS-123/reports/liberty-restrictions-coverage-refresh-heartbeat.md`.
- Slice AI-OPS-124 (derechos/atlas publicación periódica): contrato de export del Atlas endurecido en `export_liberty_restrictions_snapshot.py` con artefactos tabulares (`irlc_by_fragment.parquet`, `accountability_edges.parquet`), diff estructurado por snapshot (`added/removed/unchanged`) y changelog append-only estable (`docs/etl/runs/liberty_restrictions_snapshot_changelog.jsonl`); lane `just parl-export-liberty-restrictions-snapshot` dockerizado para asegurar dependencia parquet y evidencia en `docs/etl/sprints/AI-OPS-124/reports/liberty-atlas-publication-contract.md`.
- Slice AI-OPS-125 (derechos/atlas público distribución): publicación reproducible del bundle del Atlas en `etl/data/published` + espejo opcional GH Pages con `scripts/publish_liberty_atlas_artifacts.py` (artefactos versionados por `snapshot_date` y release `latest`) y chequeo estricto de continuidad/release con `scripts/report_liberty_atlas_changelog_continuity.py`; lanes nuevos `just parl-publish-liberty-atlas-artifacts` + `just parl-check-liberty-atlas-changelog-continuity`, integrados en `parl-liberty-restrictions-pipeline`, con evidencia en `docs/etl/sprints/AI-OPS-125/reports/liberty-atlas-public-distribution-continuity.md`.
- Slice AI-OPS-126 (derechos/atlas público frescura+drift): heartbeat append-only para `release-latest` multi-superficie (`published`/GH Pages/HF) con chequeos estrictos de frescura (`stale_snapshot`) y paridad de release (`drift`) en `scripts/report_liberty_atlas_release_heartbeat.py`, más ventana estricta `last N` en `scripts/report_liberty_atlas_release_heartbeat_window.py`; lanes nuevos `just parl-report-liberty-atlas-release-heartbeat` + `just parl-check-liberty-atlas-release-heartbeat-window`, integración en `parl-liberty-restrictions-pipeline` y tests dedicados, con evidencia en `docs/etl/sprints/AI-OPS-126/reports/liberty-atlas-release-freshness-heartbeat.md`.
- Slice AI-OPS-127 (derechos/atlas HF alias contract): hardening del publish HF para exigir `published/liberty-restrictions-atlas-release-latest.json` alineado con `snapshot_date` (`scripts/publicar_hf_snapshot.py` + `--require-liberty-atlas-release-latest`), inclusión explícita del alias en el bundle HF y propagación de metadata de contrato en `manifest.json/latest.json`; además, `report_liberty_atlas_release_heartbeat.py` resuelve `HF_DATASET_REPO_ID/HF_USERNAME` desde `.env` para evitar falsos `hf_repo_unresolved`, y la ventana strict queda endurecida por defecto con `max_hf_unavailable=0` (`justfile`). Evidencia en `docs/etl/sprints/AI-OPS-127/reports/liberty-atlas-hf-release-alias-contract.md`.
- Slice AI-OPS-128 (derechos/atlas strict `max_degraded=0`): se endurece el contrato por defecto en `justfile` (`LIBERTY_ATLAS_RELEASE_WINDOW_MAX_DEGRADED=0`) tras confirmar estabilidad operativa de la ventana `last 20`; se valida con `just parl-report-liberty-atlas-release-heartbeat`, `just parl-check-liberty-atlas-release-heartbeat-window` y `just parl-liberty-restrictions-pipeline` en modo estricto, sin degradaciones permitidas. Evidencia en `docs/etl/sprints/AI-OPS-128/reports/liberty-atlas-release-window-max-degraded-zero.md`.
- Slice AI-OPS-129 (derechos/focus scope guard en CI): se añade `scripts/report_liberty_focus_scope_guard.py` para detectar apertura de cambios fuera de `Derechos` cuando `focus_gate` está degradado, con contrato estricto (`exit=4`) y allowlist explícita de archivos de gobernanza. Se integra en `.github/workflows/etl-tracker-gate.yml` dentro de `liberty-focus-gate-contract` con checks de fail-path (`focus_gate` degradado + ruta no-`Derechos`) y pass-path (estado `ok` + changed paths reales), manteniendo el bloqueo global existente (`--enforce-gate`) como red de seguridad. Evidencia en `docs/etl/sprints/AI-OPS-129/reports/liberty-focus-scope-guard-ci-policy.md`.
- Slice AI-OPS-130 (derechos/mapa cobertura por derecho + gate): se amplía `liberty_restrictions_seed_v1.json` con cobertura para categorías antes vacías (`privacidad`, `acceso_servicios`, `propiedad_uso`) y se endurece `report_liberty_restrictions_status.py` con el gate `rights_with_data` (`right_categories_with_data_pct`) integrado en `focus_gate`. `justfile` propaga el umbral nuevo (`LIBERTY_RESTRICTIONS_RIGHTS_WITH_DATA_MIN`, default `1.0`) en `parl-report-liberty-restrictions-status` y `parl-check-liberty-focus-gate`. Evidencia en `docs/etl/sprints/AI-OPS-130/reports/liberty-right-map-coverage-gate.md`.
- Slice AI-OPS-131 (derechos/cobertura heartbeat-window con `rights_with_data`): se alinea la observabilidad periódica con el nuevo gate del mapa por derecho, añadiendo en `report_liberty_restrictions_status_heartbeat.py` los campos `right_categories_with_data_pct` + `rights_with_data_gate_passed` y en `report_liberty_restrictions_status_heartbeat_window.py` el umbral estricto `--max-rights-with-data-gate-failed` (con checks/reasons dedicados de latest + ventana). `justfile` propaga el umbral mediante `LIBERTY_RESTRICTIONS_STATUS_HEARTBEAT_MAX_RIGHTS_WITH_DATA_GATE_FAILED` en `parl-check-liberty-restrictions-status-heartbeat-window`. Evidencia en `docs/etl/sprints/AI-OPS-131/reports/liberty-restrictions-coverage-heartbeat-rights-gate.md`.
- Slice AI-OPS-132 (derechos/representatividad fuente+territorio en cobertura): se cierran controles explícitos por fuente/scope en el status (`coverage_by_source`, `coverage_by_scope`, `sources_with_assessments_pct`, `scopes_with_assessments_pct`) con gates nuevos `source_representativity_gate` y `scope_representativity_gate` dentro de `focus_gate`, ambos configurables por umbrales (`sources/scopes min pct` y `min_assessment_sources/scopes`). El heartbeat persiste estos gates y la ventana strict añade `--max-source-representativity-gate-failed` + `--max-scope-representativity-gate-failed` con checks/reasons dedicados de ventana y latest. `justfile` propaga todos los nuevos umbrales para status/focus/window. Evidencia en `docs/etl/sprints/AI-OPS-132/reports/liberty-restrictions-source-scope-representativity-gates.md`.
- Slice AI-OPS-133 (derechos/doble cobertura por fuente+scope): se endurece la representatividad de cobertura para exigir señal dual (`IRLC + accountability`) por fuente y por ámbito territorial. `report_liberty_restrictions_status.py` añade `sources_with_dual_coverage_pct/scopes_with_dual_coverage_pct` y gates `source_dual_coverage_gate/scope_dual_coverage_gate` dentro de `focus_gate`; el heartbeat persiste nuevos percentiles/totales/gates; y la ventana strict añade `--max-source-dual-coverage-gate-failed` + `--max-scope-dual-coverage-gate-failed` con checks/reasons dedicados de ventana y latest. `justfile` propaga los umbrales en status/focus/window. Evidencia en `docs/etl/sprints/AI-OPS-133/reports/liberty-restrictions-dual-coverage-gates.md`.
- Slice AI-OPS-134 (derechos/calidad de evidencia primaria en accountability): se añade gate explícito para exigir trazabilidad primaria en edges de responsabilidad (`source_url`, `evidence_date`, `evidence_quote`). `report_liberty_restrictions_status.py` incorpora métricas `accountability_edges_total`, `accountability_edges_with_primary_evidence_total`, `accountability_edges_with_primary_evidence_pct` y `accountability_primary_evidence_gate` con umbrales configurables; heartbeat y ventana strict propagan el gate (`--max-accountability-primary-evidence-gate-failed`) con checks/reasons dedicados de ventana y latest. `justfile` propaga los umbrales en status/focus/window. Evidencia en `docs/etl/sprints/AI-OPS-134/reports/liberty-restrictions-accountability-primary-evidence-gate.md`.
- Slice AI-OPS-135 (derechos/evidencia primaria poblada + contrato estricto): se endurece el lane sancionador para poblar y exigir evidencia primaria por `responsibility_hint` (`source_url`, `evidence_date`, `evidence_quote`) en `legal_fragment_responsibilities`: validación contractual en `validate_sanction_norms_seed.py`, persistencia/upsert en `import_sanction_norms_seed.py` y observabilidad de cobertura en `report_sanction_norms_seed_status.py` (`responsibility_primary_evidence_coverage_pct`). Además, el gate de foco pasa a defaults estrictos (`LIBERTY_RESTRICTIONS_ACCOUNTABILITY_PRIMARY_EVIDENCE_MIN_PCT=1.0`, `LIBERTY_RESTRICTIONS_MIN_ACCOUNTABILITY_PRIMARY_EVIDENCE_EDGES=1`) con corrida reproducible `ok` (`15/15` edges con evidencia primaria) y fail-path controlado (`exit=2`) bajo umbral imposible. Evidencia en `docs/etl/sprints/AI-OPS-135/reports/liberty-accountability-primary-evidence-seed-hardening.md`.
- Slice AI-OPS-136 (derechos/cadena directa con gate de evidencia primaria): `report_liberty_direct_accountability_scores.py` añade métricas `direct_edges_with_primary_evidence_total/direct_edges_with_primary_evidence_pct` y check `direct_primary_evidence_gate`, integrado en el `gate.passed` de cadena directa; `justfile` propaga umbrales estrictos (`LIBERTY_DIRECT_ACCOUNTABILITY_PRIMARY_EVIDENCE_MIN_PCT=1.0`, `LIBERTY_DIRECT_ACCOUNTABILITY_MIN_PRIMARY_EVIDENCE_EDGES=1`) para report/check. Corrida reproducible `ok` (`direct_edges_with_primary_evidence_total=19/19`) y fail-path contractual (`min_pct=1.1`, `min_edges=20`, `exit=2`). Evidencia en `docs/etl/sprints/AI-OPS-136/reports/liberty-direct-accountability-primary-evidence-gate.md`.
- Slice AI-OPS-137 (derechos/cadena indirecta persona+ventana temporal): `liberty_indirect_responsibility_edges` incorpora `actor_person_name/actor_role_title/appointment_start_date/appointment_end_date`; `validate_liberty_indirect_accountability_seed.py` valida coherencia de ventana y consistencia temporal con `evidence_date`; `report_liberty_indirect_accountability_status.py` añade métricas de cobertura personal temporal (`attributable_edges_with_actor_person_total`, `attributable_edges_with_valid_person_window_total`, `..._pct`) y gate `indirect_person_window_gate`; `justfile` propaga defaults estrictos (`LIBERTY_INDIRECT_PERSON_WINDOW_MIN=1.0`, `LIBERTY_INDIRECT_MIN_PERSON_WINDOW_EDGES=1`). Corrida reproducible `ok` (`attributable_edges_with_valid_person_window_total=9/9`) y fail-path contractual (`person_window_min=1.1`, `min_edges=20`, `exit=2`). Evidencia en `docs/etl/sprints/AI-OPS-137/reports/liberty-indirect-accountability-person-window-gate.md`.
- Slice AI-OPS-138 (derechos/scoring personal reproducible): se añade `report_liberty_personal_accountability_scores.py` para calcular `responsibility_score_personal` (normalizado 0-100) con descomposición por rol, periodo y fuerza probatoria, combinando edges directos con `person_id` y cadena indirecta atribuible con ventana temporal válida. `justfile` incorpora `parl-report/check-liberty-personal-accountability-*` y el pipeline `parl-liberty-restrictions-pipeline` los ejecuta tras la cadena indirecta; `export_liberty_restrictions_snapshot.py` publica `personal_accountability_scores`, `personal_accountability_summary` y `persons_scored_total`. Corrida reproducible `ok` (`persons_scored_total=9`, `personal_edges_with_primary_evidence_pct=1.0`, `indirect_person_edges_with_valid_window_pct=1.0`) y fail-path contractual (`min_persons_scored=20`, thresholds imposibles, `exit=2`). Evidencia en `docs/etl/sprints/AI-OPS-138/reports/liberty-personal-accountability-scoring-lane.md`.
- Slice AI-OPS-139 (derechos/scoring personal sin sesgo por `top_n`): `report_liberty_personal_accountability_scores.py` separa el ranking completo (`all_person_scores`) de la salida capada (`top_person_scores`) para que `top_n` sea solo visualización y no altere `persons_scored_total` ni gates; añade `totals.top_person_scores_total` y nota metodológica explícita. Se añade test de regresión (`test_persons_scored_total_not_truncated_by_top_n`) y corrida contractual reproducible (`top_n=1` vs `top_n=200`) con estabilidad de total (`9==9`) + fail-path (`min_persons_scored=99`, `exit=2`). Evidencia en `docs/etl/sprints/AI-OPS-139/reports/liberty-personal-accountability-topn-contract.md`.
- Slice AI-OPS-140 (derechos/identidad personal indirecta en scoring): `report_liberty_personal_accountability_scores.py` añade observabilidad explícita de resolución de identidad para edges indirectos con `indirect_identity_resolution_pct`, `indirect_person_edges_identity_resolved_total`, check `indirect_identity_resolution_gate` y muestra operativa `indirect_identity_unresolved_sample`; `justfile` propaga umbrales dedicados (`LIBERTY_PERSONAL_INDIRECT_IDENTITY_RESOLUTION_MIN_PCT`, `LIBERTY_PERSONAL_MIN_INDIRECT_IDENTITY_RESOLUTION_EDGES`) en report/check. Corrida contractual reproducible: pass observabilidad (`resolution_pct=0.0`, gate true con min `0.0`) + fail-path estricto (`resolution_min=1.0`, `exit=2`). Evidencia en `docs/etl/sprints/AI-OPS-140/reports/liberty-personal-identity-resolution-gate.md`.
- Slice AI-OPS-141 (derechos/cola accionable de identidad personal indirecta): nuevo lane `report_liberty_person_identity_resolution_queue.py` que transforma backlog de no resueltos en cola reproducible JSON+CSV priorizada por actor (`queue_key`, `edges_total`, `fragments_total`, ventana de evidencia), con métricas `indirect_identity_resolution_pct/indirect_identity_unresolved_pct` y gate contractual `identity_resolution_gate`; `justfile` añade `parl-report-liberty-person-identity-resolution-queue` + `parl-check-liberty-person-identity-resolution-gate` e integra ambos en `parl-liberty-restrictions-pipeline`. Corrida reproducible (`20260223T215635Z`): pass (`status=ok`, `queue_rows_total=9`) y fail-path (`identity_resolution_min_pct=1.0`, `exit=2`), con tests focales `Ran 11` y suite `Derechos` `Ran 69` en verde. Evidencia en `docs/etl/sprints/AI-OPS-141/reports/liberty-person-identity-resolution-queue-lane.md`.
- Slice AI-OPS-142 (derechos/aplicar identidad personal indirecta en DB): se añade tabla `person_name_aliases` y lane reproducible `validate/import` para `liberty_person_identity_resolution_seed_v1` (`scripts/validate_liberty_person_identity_resolution_seed.py`, `scripts/import_liberty_person_identity_resolution_seed.py`) que materializa `actor_person_name -> person_id`. `justfile` integra `parl-validate/import-liberty-person-identity-seed` en `parl-liberty-restrictions-pipeline`. `report_liberty_personal_accountability_scores.py` y `report_liberty_person_identity_resolution_queue.py` pasan a resolver identidad por `full_name` exacto o alias (`person_name_aliases.canonical_alias`) y publican desglose `resolved_exact_name`/`resolved_alias`. Corrida reproducible (`20260223T220708Z`): `aliases_total=9`, `persons_with_aliases_total=5`, scoring con `indirect_identity_resolution_pct=1.0`, queue con `queue_rows_total=0`; fail-path contractual (`min_pct=1.1`) mantiene `exit=2`; tests focales `Ran 17` y suite `Derechos` `Ran 75` en verde. Evidencia en `docs/etl/sprints/AI-OPS-142/reports/liberty-person-identity-apply-lane.md`.
- Slice AI-OPS-143 (derechos/procedencia de identidad personal): se endurece `person_name_aliases` con `source_kind/evidence_date/evidence_quote` para separar resolución manual de resolución oficial; `validate/import_liberty_person_identity_resolution_seed.py` exige contrato por `source_kind` (campos de evidencia obligatorios en `official_*`), y `report_liberty_personal_accountability_scores.py` + `report_liberty_person_identity_resolution_queue.py` añaden métricas/gates de calidad de procedencia (`indirect_person_edges_identity_resolved_alias_non_manual_total`, `indirect_non_manual_alias_resolution_pct`, checks `indirect_non_manual_alias_resolution_gate` / `identity_non_manual_alias_resolution_gate`). `justfile` propaga umbrales dedicados en report/check para scoring y queue. Corrida reproducible (`20260223T221925Z`): import `manual_aliases_total=9`, `official_aliases_total=0`; scoring/queue pass con `indirect_identity_resolution_pct=1.0` y `indirect_non_manual_alias_resolution_pct=0.0`; fail-path contractual con `*_NON_MANUAL_ALIAS_RESOLUTION_MIN_PCT=1.0` devuelve `exit=2`; tests focales `Ran 20` y suite `Derechos` `Ran 78` en verde. Evidencia en `docs/etl/sprints/AI-OPS-143/reports/liberty-person-identity-provenance-gate.md`.
- Slice AI-OPS-144 (derechos/backlog de migración manual->official): se operacionaliza la migración de alias con `manual_alias_upgrade_queue_rows` (JSON+CSV) en `report_liberty_person_identity_resolution_queue.py`, métricas de share manual (`manual_alias_share_pct`, `manual_alias_upgrade_edge_impact_pct`) y gate explícito `manual_alias_share_gate`; en paralelo, `import_liberty_person_identity_resolution_seed.py` evita downgrade de procedencia (`aliases_source_kind_downgrade_prevented`). Corrida reproducible (`20260223T222707Z`): queue `status=ok`, `manual_alias_upgrade_queue_rows_total=9`, `manual_alias_share_pct=1.0`; fail-path con `manual_alias_share_max=0.0` devuelve `exit=2`; tests focales `Ran 22` y suite `Derechos` `Ran 80` en verde. Evidencia en `docs/etl/sprints/AI-OPS-144/reports/liberty-person-identity-manual-upgrade-backlog-gate.md`.
- Slice AI-OPS-145 (derechos/source-guard de identidad + paridad de gate personal): `import_liberty_person_identity_resolution_seed.py` bloquea retarget manual sobre alias ya `official_*` (nuevo contador `aliases_retarget_downgrade_prevented`) y `report_liberty_personal_accountability_scores.py` añade métricas/gate de `manual_alias_share` en paridad con la cola; `justfile` propaga `LIBERTY_PERSONAL_MANUAL_ALIAS_SHARE_MAX` y `LIBERTY_PERSONAL_MIN_ALIAS_ROWS_FOR_MANUAL_SHARE_GATE` en report/check personal. Corrida reproducible (`20260223T223309Z`): scoring `status=ok`, `manual_alias_share_pct=1.0`; fail-path strict de `manual_alias_share` y `non_manual_alias` en personal/queue devuelve `exit=2`; contrato de replay manual sobre alias oficial confirma `aliases_retarget_downgrade_prevented=1` y preserva `source_kind=official_nombramiento` + `person_full_name=Alicia Martin Gomez`; tests focales `Ran 20` y suite `Derechos` `Ran 81` en verde. Evidencia en `docs/etl/sprints/AI-OPS-145/reports/liberty-person-identity-source-guard-personal-gate.md`.
- Slice AI-OPS-146 (derechos/evidencia obligatoria para alias `official_*`): `report_liberty_personal_accountability_scores.py` y `report_liberty_person_identity_resolution_queue.py` añaden cobertura/gate explícito de evidencia oficial (`official_alias_rows_with_evidence_total`, `official_alias_rows_missing_evidence_total`, `official_alias_evidence_coverage_pct`, `official_alias_evidence_gate`) y `justfile` propaga umbrales dedicados (`LIBERTY_PERSONAL_OFFICIAL_ALIAS_EVIDENCE_MIN_PCT`, `LIBERTY_PERSONAL_MIN_OFFICIAL_ALIAS_ROWS_FOR_EVIDENCE_GATE`, `LIBERTY_PERSON_IDENTITY_OFFICIAL_ALIAS_EVIDENCE_MIN_PCT`, `LIBERTY_PERSON_IDENTITY_MIN_OFFICIAL_ALIAS_ROWS_FOR_EVIDENCE_GATE`). Corrida reproducible (`20260223T224358Z`): lanes en `status=ok` y fail-path contractual por drift en alias oficial (`1/1 -> 0/1` con evidencia) devuelve `exit=2` en personal/queue; se mantienen fail-paths strict existentes (`manual_alias_share`, `non_manual_alias`) con `exit=2`; tests focales `Ran 22` y suite `Derechos` `Ran 83` en verde. Evidencia en `docs/etl/sprints/AI-OPS-146/reports/liberty-person-identity-official-evidence-gate.md`.
- Slice AI-OPS-147 (derechos/progreso exigible de migración `manual_seed -> official_*`): `report_liberty_personal_accountability_scores.py` y `report_liberty_person_identity_resolution_queue.py` añaden gate explícito de cuota oficial (`official_alias_share_pct`, `official_alias_share_gate`) para evitar falsos verdes con `official_alias_rows_total=0`; `justfile` propaga umbrales dedicados (`LIBERTY_PERSONAL_OFFICIAL_ALIAS_SHARE_MIN_PCT`, `LIBERTY_PERSONAL_MIN_ALIAS_ROWS_FOR_OFFICIAL_SHARE_GATE`, `LIBERTY_PERSON_IDENTITY_OFFICIAL_ALIAS_SHARE_MIN_PCT`, `LIBERTY_PERSON_IDENTITY_MIN_ALIAS_ROWS_FOR_OFFICIAL_SHARE_GATE`) en report/check personal+queue. Corrida reproducible (`20260223T225159Z`): pass de observabilidad (`official_alias_share_pct=0.0`, gate true con min `0.0`) y fail-path contractual estricto (`official_alias_share_min_pct=0.1`, `min_alias_rows_for_official_share_gate=1`) devuelve `exit=2` en ambos lanes; tests focales `Ran 17` y suite `Derechos` `Ran 85` en verde. Evidencia en `docs/etl/sprints/AI-OPS-147/reports/liberty-person-identity-official-alias-share-gate.md`.
- Slice AI-OPS-148 (derechos/trazabilidad `source_records` en alias `official_*`): `person_name_aliases` añade `source_record_pk` (schema + compat + índice), `validate/import_liberty_person_identity_resolution_seed.py` aceptan referencias `source_record_id/source_record_pk` y exponen contadores de resolución, y `report_liberty_personal_accountability_scores.py` + `report_liberty_person_identity_resolution_queue.py` añaden cobertura/gate explícito `official_alias_source_record_coverage_pct` + `official_alias_source_record_gate`. `justfile` propaga umbrales dedicados en report/check personal+queue (`LIBERTY_PERSONAL_OFFICIAL_ALIAS_SOURCE_RECORD_MIN_PCT`, `LIBERTY_PERSONAL_MIN_OFFICIAL_ALIAS_ROWS_FOR_SOURCE_RECORD_GATE`, `LIBERTY_PERSON_IDENTITY_OFFICIAL_ALIAS_SOURCE_RECORD_MIN_PCT`, `LIBERTY_PERSON_IDENTITY_MIN_OFFICIAL_ALIAS_ROWS_FOR_SOURCE_RECORD_GATE`). Corrida reproducible (`20260223T230526Z`): pass en seed manual (`official_alias_rows_total=0`, gate `true`) y fail-path contractual con alias `official_*` sin `source_record_pk` (`official_alias_rows_total=1`, `with_source_record=0`, `official_alias_source_record_gate=false`, `exit=2` en personal/queue); tests focales `Ran 28` y suite `Derechos` `Ran 89` en verde. Evidencia en `docs/etl/sprints/AI-OPS-148/reports/liberty-person-identity-official-source-record-gate.md`.
- Slice AI-OPS-149 (derechos/colas accionables para gaps `official_*`): `report_liberty_person_identity_resolution_queue.py` añade dos colas operativas para cerrar gates oficiales con remediación concreta: `official_alias_evidence_upgrade_queue_rows` (faltan `source_url/evidence_date/evidence_quote`) y `official_alias_source_record_upgrade_queue_rows` (falta `source_record_pk`), cada una con prioridad por impacto (`edges_total`, `fragments_total`, ventana de evidencia), `queue_key` estable y `next_action`. Se añaden checks explícitos de visibilidad de backlog (`official_alias_evidence_backlog_visible`, `official_alias_source_record_backlog_visible`), totales contractuales y export CSV dedicados (`--official-alias-evidence-upgrade-csv-out`, `--official-alias-source-record-upgrade-csv-out`) propagados por `justfile` (`LIBERTY_PERSON_IDENTITY_OFFICIAL_EVIDENCE_UPGRADE_QUEUE_CSV_OUT`, `LIBERTY_PERSON_IDENTITY_OFFICIAL_SOURCE_RECORD_UPGRADE_QUEUE_CSV_OUT`) en report/check. Corrida reproducible (`20260223T231638Z`): pass observabilidad (`official_alias_rows_total=0`, ambas colas `0`) y fail-path contractual (`official_alias_rows_total=1`, `missing_evidence=1`, `missing_source_record=1`) con colas `1/1`, checks de visibilidad `true` y `exit=2`; tests focales `Ran 8` + suite `Derechos` `Ran 89` en verde. Evidencia en `docs/etl/sprints/AI-OPS-149/reports/liberty-person-identity-official-gap-actionable-queues.md`.
- Slice AI-OPS-150 (derechos/review-apply reproducible de upgrades `manual->official`): se cierra el loop operativo de la fila `103` con `scripts/export_liberty_person_identity_official_upgrade_review_queue.py` (cola única de revisión que une backlog manual + gaps `official_*`) y `scripts/apply_liberty_person_identity_official_upgrade_reviews.py` (aplica decisiones CSV sobre la seed con guardrail anti-downgrade). `justfile` añade lanes dedicados de export/apply. Corrida reproducible (`20260223T232635Z`): review queue `rows_total=9`, apply sample `approved_rows=1`, `updated_rows=1`; post-apply `manual_alias_upgrade_queue_rows_total` baja `9 -> 8`, `official_alias_rows_total=1`, `official_alias_rows_missing_evidence_total=0`, `official_alias_rows_missing_source_record_total=1`; tests focales `Ran 3` + suite `Derechos` `Ran 92` en verde. Evidencia en `docs/etl/sprints/AI-OPS-150/reports/liberty-person-identity-official-upgrade-review-apply-loop.md`.
- Slice AI-OPS-151 (derechos/autoresolución de `source_record_pk` en apply): `scripts/apply_liberty_person_identity_official_upgrade_reviews.py` incorpora `--db` para cargar lookup desde `source_records` y completar automáticamente `source_record_pk` cuando la revisión trae `source_id+source_record_id`; además publica métricas explícitas (`source_record_pk_auto_resolved`, `source_record_pk_auto_resolve_missed`, `source_record_lookup.rows_total`) y `justfile` propaga `--db {{db_path}}` en `parl-apply-liberty-person-identity-official-upgrade-reviews`. Corrida contractual (`20260223T232954Z`): dry-run con lookup real `rows_total=173070`, `source_record_pk_auto_resolved=1`, `validation.valid=true`; tests focales `Ran 4` + suite `Derechos` `Ran 93` en verde. Evidencia en `docs/etl/sprints/AI-OPS-151/reports/liberty-person-identity-source-record-autoresolve.md`.
- Slice AI-OPS-152 (derechos/prefill de `source_record_pk` en export de review queue): `scripts/export_liberty_person_identity_official_upgrade_review_queue.py` ahora carga lookup opcional desde `source_records` y precompleta `source_record_pk` durante la exportación cuando hay `source_id+source_record_id`, añadiendo trazabilidad por fila (`source_record_pk_lookup_status`) y contadores contractuales (`source_record_pk_lookup_keys_total`, `source_record_pk_lookup_prefilled_total`, `source_record_pk_lookup_miss_total`, `source_record_lookup_rows_total`). Se extienden tests en `tests/test_export_liberty_person_identity_official_upgrade_review_queue.py` para cubrir el path `prefilled_from_db`. Corrida contractual (`20260223T233847Z`): tests focales `Ran 5`, suite `Derechos` `Ran 94`, y contrato de prefill `keys=1`, `prefilled=1`, `miss=0`, `source_record_pk=125908`, `lookup_status=prefilled_from_db`. Evidencia en `docs/etl/sprints/AI-OPS-152/reports/liberty-person-identity-review-queue-source-record-prefill.md`.
- Slice AI-OPS-153 (derechos/cola accionable vs placeholders en review queue): `scripts/export_liberty_person_identity_official_upgrade_review_queue.py` añade clasificación operativa por fila (`actionability`, `actionability_reason`) para separar backlog real (`actionable`) de placeholders de semilla (`likely_not_actionable_seed_placeholder`), incorpora contadores contractuales (`actionable_rows_total`, `likely_not_actionable_rows_total`) y añade controles `--only-actionable` + `--strict-empty-actionable` (exit `4` con cola accionable abierta). `justfile` integra lanes `parl-export-liberty-person-identity-official-upgrade-review-queue-actionable` y `parl-check-liberty-person-identity-official-upgrade-review-queue-actionable-empty`. Corrida contractual (`20260223T234425Z`): tests focales `Ran 5`, suite `Derechos` `Ran 94`; en DB real `rows_total=0`, `actionable_rows_total=0`, strict-empty pass; fixture determinista valida split `1 actionable / 1 placeholder`. Evidencia en `docs/etl/sprints/AI-OPS-153/reports/liberty-person-identity-review-queue-actionability-gate.md`.
- Slice AI-OPS-154 (derechos/observabilidad continua de cola accionable): se añade heartbeat append-only + ventana estricta para el cierre operativo de la review queue accionable (`scripts/report_liberty_person_identity_official_upgrade_review_queue_actionable_heartbeat.py`, `scripts/report_liberty_person_identity_official_upgrade_review_queue_actionable_heartbeat_window.py`) con dedupe por `heartbeat_id`, checks `latest` + `last N` y fail-path contractual cuando reaparece backlog accionable. `justfile` incorpora nuevos lanes (`parl-report/check-liberty-person-identity-official-upgrade-review-queue-actionable-heartbeat*`) e integra report + `strict-empty` + ventana en `parl-liberty-restrictions-pipeline`; CI (`liberty-focus-gate-contract`) ejecuta tests del nuevo contrato. Corrida de cierre (`20260223T235521Z`): tests focales `Ran 5`, suite `Derechos` `Ran 99`; estado real en DB `actionable_rows_total=0`, heartbeat `status=ok`, ventana `status=ok` (`failed_in_window=0`, `actionable_nonempty_runs_in_window=0`). Evidencia en `docs/etl/sprints/AI-OPS-154/reports/liberty-person-identity-actionable-heartbeat-window-gate.md`.
- Slice AI-OPS-155 (normativa/lineage reproducible por norma): el lane sancionador incorpora contrato explícito `deroga/modifica/desarrolla` con nueva tabla `legal_norm_lineage_edges` (schema aditivo + índices), validación de semilla (`lineage_hints`) en `validate_sanction_norms_seed.py`, import idempotente con alta automática de normas relacionadas no presentes en seed (`lineage_related_norms_inserted`) en `import_sanction_norms_seed.py`, y observabilidad de cobertura+evidencia primaria en `report_sanction_norms_seed_status.py` (`lineage_edges_total`, `norms_with_lineage`, `lineage_primary_evidence_coverage_pct`, checks de cadena). Además, se añade guardrail en `report_liberty_restrictions_status.py` para calcular cobertura sobre normas con fragmentos y evitar degradación artificial del foco por referencias `lineage_ref` sin fragmentación. Corrida de cierre (`20260224T000517Z`): validación `lineage_hints_total=8`, import `lineage_related_norms_inserted=4` + `lineage_edges_inserted=8`, status `ok` con `norms_with_lineage=8/8` y `lineage_primary_evidence_coverage_pct=1.0`; tests focales del lane `Ran 8`, suite `Derechos` `Ran 100 (skipped=1)` y `PRAGMA foreign_key_check` sin violaciones. Evidencia en `docs/etl/sprints/AI-OPS-155/reports/sanction-norms-lineage-seed-lane.md`.
- Slice AI-OPS-156 (normativa/evidencia multipista por responsabilidad): el lane sancionador añade tabla dedicada `legal_fragment_responsibility_evidence` (schema aditivo + indices), contrato opcional `responsibility_hints[].evidence_items[]` en `validate_sanction_norms_seed.py`, import idempotente en `import_sanction_norms_seed.py` con fallback `boe_publicacion` cuando falten `evidence_items`, y observabilidad contractual en `report_sanction_norms_seed_status.py` (`responsibilities_with_evidence_items_total`, `responsibility_evidence_items_total`, `responsibility_evidence_items_with_primary_fields_total`, coberturas y checks de evidencia multipista). Corrida de cierre (`20260224T001801Z`): import `responsibility_evidence_inserted=15` y `legal_fragment_responsibility_evidence_total=15`; status `ok` con `responsibilities_with_evidence_items_total=15/15`, `responsibility_evidence_items_with_primary_fields_total=15/15`, `responsibility_evidence_item_primary_fields_coverage_pct=1.0`; tests focales `Ran 9`, suite `Derechos` `Ran 100 (skipped=1)` y `PRAGMA foreign_key_check` sin violaciones. Evidencia en `docs/etl/sprints/AI-OPS-156/reports/sanction-norms-responsibility-evidence-lane.md`.
- Slice AI-OPS-157 (normativa/trazabilidad `source_record_pk` en evidencia multipista): `import_sanction_norms_seed.py` incorpora autoresolución de `source_record_pk` para `responsibility_hints[].evidence_items[]` cuando llega `source_id + source_record_id` (lookup cacheado en `source_records`) y contadores explícitos (`responsibility_evidence_source_record_pk_auto_resolved`, `responsibility_evidence_source_record_pk_auto_resolve_missed`). `validate_sanction_norms_seed.py` endurece contrato opcional para refs documentales (`source_record_id` no vacío con `source_id` obligatorio, `source_record_pk` entero positivo). `report_sanction_norms_seed_status.py` añade observabilidad de cobertura documental (`responsibility_evidence_items_with_source_record_total`, `responsibility_evidence_items_missing_source_record`, `responsibility_evidence_item_source_record_coverage_pct`, check informativo `responsibility_evidence_source_record_chain_started`). Corrida de cierre (`20260224T002457Z`): import en DB real sin refs resolubles (`auto_resolved=0`, `auto_resolve_missed=0`) y status `ok` con cobertura `source_record_pk` `0/15`; tests focales `Ran 10`, suite `Derechos` `Ran 100 (skipped=1)` y `PRAGMA foreign_key_check` sin violaciones. Evidencia en `docs/etl/sprints/AI-OPS-157/reports/sanction-norms-responsibility-evidence-source-record-autoresolve.md`.
- Slice AI-OPS-158 (normativa/cobertura `source_record_pk` al 100% en evidencia multipista): se enriquece `sanction_norms_seed_v1` con `responsibility_hints[].evidence_items[]` explícitos para los 15 edges (`source_id=boe_api_legal`, `source_record_id=<boe_id>`), y `import_sanction_norms_seed.py` añade fallback de bootstrap `_ensure_source_record(...)` para crear filas faltantes en `source_records` sin sobrescribir registros existentes, manteniendo trazabilidad reproducible por edge (`norma -> fragmento -> responsabilidad -> evidencia -> source_record_pk`). Contadores nuevos: `responsibility_evidence_source_record_seed_rows_inserted`, junto a `responsibility_evidence_source_record_pk_auto_resolved/auto_resolve_missed`. Corrida de cierre (`20260224T003121Z`): validación `responsibility_evidence_items_total=15`, import `auto_resolved=7`, `seed_rows_inserted=8`, `auto_resolve_missed=0`, status `ok` con `responsibility_evidence_items_with_source_record_total=15/15` y `responsibility_evidence_item_source_record_coverage_pct=1.0`; tests focales `Ran 11`, suite `Derechos` `Ran 100 (skipped=1)` y `PRAGMA foreign_key_check` sin violaciones. Evidencia en `docs/etl/sprints/AI-OPS-158/reports/sanction-norms-responsibility-evidence-source-record-coverage-seed-upsert.md`.
- Slice AI-OPS-159 (normativa/split de procedencia `seed` vs `non-seed` en `source_record_pk`): `report_sanction_norms_seed_status.py` añade métricas de composición (`responsibility_evidence_items_with_seed_source_record_total`, `responsibility_evidence_items_with_non_seed_source_record_total`), cobertura `responsibility_evidence_item_non_seed_source_record_coverage_pct` y check `responsibility_evidence_non_seed_source_record_chain_started`; `tests/test_report_sanction_norms_seed_status.py` incorpora regresión específica del path `non-seed`. Corrida de cierre (`20260224T003834Z`): import `auto_resolved=15`, `seed_rows_inserted=0`, `auto_resolve_missed=0`; status `ok` con cobertura documental `15/15`, split `seed=15`, `non-seed=0` y check `responsibility_evidence_non_seed_source_record_chain_started=false`; tests focales `Ran 12`, suite `Derechos` `Ran 100 (skipped=1)` y `PRAGMA foreign_key_check` sin violaciones. Evidencia en `docs/etl/sprints/AI-OPS-159/reports/sanction-norms-responsibility-evidence-source-record-provenance-split.md`.
- Slice AI-OPS-160 (normativa/cola accionable `seed -> non-seed` para `source_record_pk`): se añade `scripts/export_sanction_norms_seed_source_record_upgrade_queue.py` para materializar backlog reproducible de evidencias aún ligadas a `source_records` seed (`seed_schema_version=sanction_norms_seed_v1`) con export JSON/CSV y `queue_key` estable por `responsibility_evidence_id`; `justfile` incorpora vars dedicadas y el lane `parl-export-sanction-norms-seed-source-record-upgrade-queue`, integrado en `parl-sanction-norms-seed-pipeline`. Corrida de cierre (`20260224T004510Z`): lane `status=ok`, queue `status=degraded`, `queue_rows_total=15` (`8` normas, `8` fragmentos, `15` responsabilidades), cobertura documental se mantiene `15/15` con split `seed=15`, `non-seed=0`; tests focales `Ran 14`, suite `Derechos` `Ran 100 (skipped=1)` y `PRAGMA foreign_key_check` sin violaciones. Evidencia en `docs/etl/sprints/AI-OPS-160/reports/sanction-norms-seed-source-record-upgrade-queue.md`.
- Slice AI-OPS-161 (normativa/aplicar cierre de cola `seed -> non-seed`): se añade backfill canónico BOE en `scripts/backfill_sanction_norms_boe_source_records.py` (`source_record_id=boe_ref:<BOE-ID>`) y aplicador de repoint en `scripts/apply_sanction_norms_seed_source_record_upgrade_queue.py` para migrar `legal_fragment_responsibility_evidence.source_record_pk` desde payload seed a payload no-seed. `justfile` incorpora lanes `parl-backfill-sanction-norms-boe-source-records` y `parl-apply-sanction-norms-source-record-upgrade`, más tests focales (`tests/test_backfill_sanction_norms_boe_source_records.py`, `tests/test_apply_sanction_norms_seed_source_record_upgrade_queue.py`) dentro de `parl-test-sanction-norms-seed`. Corrida de cierre (`20260224T005304Z`): backfill `targets_total=8`, `records_inserted=8`; apply `queue_rows_seen=15`, `upgraded_rows=15`; status `responsibility_evidence_items_with_seed_source_record_total=0`, `responsibility_evidence_items_with_non_seed_source_record_total=15`, `responsibility_evidence_item_non_seed_source_record_coverage_pct=1.0`; cola post-apply `queue_rows_total=0` (`status=ok`); tests focales `Ran 16`, suite `Derechos` `Ran 100 (skipped=1)` y `PRAGMA foreign_key_check` sin violaciones. Evidencia en `docs/etl/sprints/AI-OPS-161/reports/sanction-norms-seed-source-record-upgrade-apply.md`.
- Slice AI-OPS-162 (normativa/inicio de cadena parlamentaria en evidencia de responsabilidad): se añade `scripts/backfill_sanction_norms_parliamentary_evidence.py` para detectar referencias `BOE-A-*` en `text_documents` (`parl_initiative_docs`), cruzarlas con `sanction_norm_catalog` y materializar evidencia `congreso_diario/senado_diario` por responsabilidad (roles configurables, idempotente, con actualización de filas legacy sin `evidence_date`). `report_sanction_norms_seed_status.py` amplía contrato con KPIs/checks de cobertura parlamentaria (`responsibility_evidence_items_parliamentary_total`, `responsibilities_with_parliamentary_evidence_total`, `responsibility_evidence_item_parliamentary_share_pct`, `responsibility_parliamentary_coverage_pct`, `responsibility_evidence_parliamentary_chain_started`). `justfile` incorpora lane `parl-backfill-sanction-norms-parliamentary-evidence` y test dedicado `tests/test_backfill_sanction_norms_parliamentary_evidence.py` en `parl-test-sanction-norms-seed`. Corrida de cierre (`20260224T010415Z`): backfill `docs_scanned_total=9016`, `candidate_matches_total=2`, `senado_diario=2`; status lane `ok` con `responsibility_evidence_items_total=17`, `responsibility_evidence_items_with_primary_fields_total=17`, `responsibility_evidence_items_parliamentary_total=2`, `responsibility_parliamentary_coverage_pct=0.133333`; cola `seed->non-seed` sigue vacía (`queue_rows_total=0`), tests focales `Ran 17`, suite `Derechos` `Ran 100 (skipped=1)` y `PRAGMA foreign_key_check` sin violaciones. Evidencia en `docs/etl/sprints/AI-OPS-162/reports/sanction-norms-parliamentary-evidence-backfill.md`.
- Slice AI-OPS-163 (normativa/evidencia de voto en cadena parlamentaria): se añade `scripts/backfill_sanction_norms_vote_evidence.py` para materializar `congreso_vote/senado_vote` sobre `legal_fragment_responsibility_evidence` cruzando `parl_vote_events + parl_vote_event_initiatives` con normas sancionadoras mediante reglas conservadoras legal+título (trazables por `raw_payload.match_method/match_confidence`). `report_sanction_norms_seed_status.py` amplía contrato con KPIs/checks de voto (`responsibility_evidence_items_parliamentary_vote_total`, `responsibilities_with_parliamentary_vote_evidence_total`, `responsibility_evidence_item_parliamentary_vote_share_pct`, `responsibility_parliamentary_vote_coverage_pct`, `responsibility_evidence_vote_chain_started`); `justfile` incorpora lane `parl-backfill-sanction-norms-vote-evidence`; y `parl-test-sanction-norms-seed` suma `tests/test_backfill_sanction_norms_vote_evidence.py`. Corrida de cierre (`20260224T011452Z`): backfill `vote_link_rows_scanned_total=8358`, `candidate_matches_total=26`, `evidence_inserted=20`, `evidence_updated=32`, `congreso_vote=14`, `senado_vote=38`; status lane `ok` con `responsibility_evidence_items_total=37`, `responsibility_evidence_items_parliamentary_total=22`, `responsibility_evidence_items_parliamentary_vote_total=20`, `responsibilities_with_parliamentary_evidence_total=8/15`, `responsibilities_with_parliamentary_vote_evidence_total=6/15`, `responsibility_evidence_vote_chain_started=true`; cola `seed->non-seed` cerrada (`queue_rows_total=0`), tests focales `Ran 19`, suite `Derechos` `Ran 100 (skipped=1)` y `PRAGMA foreign_key_check` sin violaciones. Evidencia en `docs/etl/sprints/AI-OPS-163/reports/sanction-norms-vote-evidence-backfill.md`.
- Slice AI-OPS-164 (normativa/evidencia de ejecución sancionadora): se añade `scripts/backfill_sanction_norms_execution_evidence.py` para materializar señal de ejecución real (`expediente_count`, `importe_total_eur`, recursos) desde `sanction_volume_observations` hacia `legal_fragment_responsibility_evidence` con matching `fragment_id` exacto y roles configurables (default `enforce`), manteniendo compatibilidad de esquema con `evidence_type='other'` + `raw_payload.record_kind='sanction_norm_execution_evidence_backfill'` y `source_url` único por observación (`#observation_id=<id>`). `report_sanction_norms_seed_status.py` amplía contrato con KPIs/checks de ejecución (`responsibility_evidence_items_execution_total`, `responsibilities_with_execution_evidence_total`, `responsibilities_missing_execution_evidence`, `responsibility_evidence_item_execution_share_pct`, `responsibility_execution_coverage_pct`, `responsibility_evidence_execution_chain_started`); `justfile` incorpora lane `parl-backfill-sanction-norms-execution-evidence`; y `parl-test-sanction-norms-seed` suma `tests/test_backfill_sanction_norms_execution_evidence.py`. Corrida de cierre (`20260224T012849Z`): backfill `observations_scanned_total=7`, `observations_with_responsibility_total=2`, `source_record_pk_resolved_total=2`, `evidence_inserted=2`; status lane `ok` con `responsibility_evidence_items_total=39`, `responsibility_evidence_items_execution_total=2`, `responsibilities_with_execution_evidence_total=2/15`, `responsibility_execution_coverage_pct=0.133333`, `responsibility_evidence_execution_chain_started=true`; cola `seed->non-seed` cerrada (`queue_rows_total=0`), tests focales `Ran 21`, suite `Derechos` `Ran 100 (skipped=1)` y `PRAGMA foreign_key_check` sin violaciones. Evidencia en `docs/etl/sprints/AI-OPS-164/reports/sanction-norms-execution-evidence-backfill.md`.
- Slice AI-OPS-165 (normativa/ejecucion+garantias procedimentales): se escala `backfill_sanction_norms_execution_evidence.py` fuera de `enforce` con roles por defecto `enforce,approve,propose,delegate` y se añade `scripts/backfill_sanction_norms_procedural_metric_evidence.py` para materializar evidencia de `% recursos estimados`, anulaciones formales y plazos (`sanction_procedural_metrics`) sobre responsabilidades por fragmento via `sanction_source_id -> fragmentos observados`; `justfile` incorpora lane `parl-backfill-sanction-norms-procedural-metric-evidence` y `parl-test-sanction-norms-seed` suma el test dedicado. Corrida de cierre (`20260224T013817Z`): `evidence_inserted=11` (ejecución ampliada) + `12` (procedimental), status `responsibility_evidence_items_execution_total=25`, `responsibilities_with_execution_evidence_total=11/15`, `responsibility_execution_coverage_pct=0.733333`, con `queue_rows_total=0` y `PRAGMA foreign_key_check` limpio; evidencia en `docs/etl/sprints/AI-OPS-165/reports/sanction-norms-execution-procedural-evidence-expansion.md`.
- Slice AI-OPS-166 (normativa/cierre de cobertura `delegate` por lineage): se activa lane reproducible de puente de ejecución `scripts/backfill_sanction_norms_execution_lineage_evidence.py`, que enlaza responsabilidades delegadas con observaciones sancionadoras via `delegate_to_observed_direct` y `shared_related_norm`, materializando `record_kind=sanction_norm_execution_lineage_bridge_backfill` en `legal_fragment_responsibility_evidence`; `report_sanction_norms_seed_status.py` incorpora ese `record_kind` al cómputo de señal de ejecución. Corrida de cierre (`20260224T014904Z`): backfill `responsibilities_scanned_total=2`, `responsibilities_with_lineage_match_total=2`, `observation_links_total=4`, `evidence_inserted=4` (`shared_related_norm=3`, `delegate_to_observed_direct=1`); status `ok` con `responsibility_evidence_items_total=66`, `responsibility_evidence_items_execution_total=29`, `responsibilities_with_execution_evidence_total=13/15`, `responsibility_execution_coverage_pct=0.866667`, cierre de `delegate=2/2` y residual `enforce=2/4`; cola `seed->non-seed` cerrada, `PRAGMA foreign_key_check` sin violaciones y tests en verde (`Ran 25` + `Ran 100`, `skipped=1`). Evidencia en `docs/etl/sprints/AI-OPS-166/reports/sanction-norms-execution-lineage-evidence-bridge.md`.
- Slice AI-OPS-167 (normativa/cierre de cobertura `enforce` y ejecución total): se ejecuta el lote pendiente del tracker con `roles=enforce` en `scripts/backfill_sanction_norms_execution_lineage_evidence.py`, `scripts/backfill_sanction_norms_execution_evidence.py` y `scripts/backfill_sanction_norms_procedural_metric_evidence.py`; la señal de ejecución por responsabilidad queda completa (`15/15`) sin abrir nueva dependencia externa. Corrida de cierre (`20260224T015316Z`): lineage `responsibilities_scanned_total=4`, `responsibilities_with_lineage_match_total=4`, `observation_links_total=7`, `evidence_inserted=7` (`shared_related_norm=4`, `delegate_to_observed_direct=1`, `direct_norm_match=2`); ejecución directa `evidence_updated=2`; procedimental `evidence_inserted=0` por ausencia de matches `enforce` en métricas piloto. Status `ok` con `responsibility_evidence_items_total=73`, `responsibility_evidence_items_execution_total=36`, `responsibilities_with_execution_evidence_total=15/15`, `responsibility_execution_coverage_pct=1.0`; cola `seed->non-seed` vacía, `PRAGMA foreign_key_check` limpio y tests en verde (`Ran 25` + `Ran 100`, `skipped=1`). Evidencia en `docs/etl/sprints/AI-OPS-167/reports/sanction-norms-enforce-execution-closure.md`.
- Slice AI-OPS-168 (normativa/expansión parlamentaria-voto en roles completos): se ejecuta el lote pendiente del tracker para `approve,propose,enforce,delegate` en `scripts/backfill_sanction_norms_parliamentary_evidence.py` + `scripts/backfill_sanction_norms_vote_evidence.py`, manteniendo cierre de ejecución y cola `seed->non-seed` en verde. Corrida (`20260224T091523Z`): parlamentario `candidate_matches_total=2`, `evidence_updated=2`; voto `candidate_matches_total=26`, `evidence_inserted=5`, `evidence_updated=52`; status `ok` con `responsibility_evidence_items_total=78`, `responsibilities_with_parliamentary_evidence_total=9/15`, `responsibilities_with_parliamentary_vote_evidence_total=7/15`, `responsibilities_with_execution_evidence_total=15/15`, `queue_rows_total=0`, `PRAGMA foreign_key_check` limpio; tests `parl-test-sanction-norms-seed` (`Ran 25`) + `parl-test-liberty-restrictions` (`Ran 100`, `OK (skipped=1)`). Evidencia en `docs/etl/sprints/AI-OPS-168/evidence/`.
- Slice AI-OPS-169 (normativa/puente de lineage en evidencia de voto): `scripts/backfill_sanction_norms_vote_evidence.py` incorpora bridges conservadores `lineage_target_to_vote_norm:desarrolla|modifica` y `lineage_shared_deroga_related_norm` para transferir señal de voto entre normas sancionadoras relacionadas, con trazabilidad explícita (`candidate_boe_id`, `bridge_kind`, `bridge_from_boe_id`, `bridge_anchor_related_*`) y test de regresión en `tests/test_backfill_sanction_norms_vote_evidence.py`. Corrida (`20260224T092206Z`): voto `candidate_matches_total=69`, `evidence_inserted=17`, `evidence_updated=102`; status `ok` con `responsibility_evidence_items_total=95`, `responsibilities_with_parliamentary_evidence_total=11/15`, `responsibilities_with_parliamentary_vote_evidence_total=11/15`, `responsibility_parliamentary_coverage_pct=0.733333`, `responsibility_parliamentary_vote_coverage_pct=0.733333`, ejecución estable `15/15`, `queue_rows_total=0`, `PRAGMA foreign_key_check` limpio; tests `parl-test-sanction-norms-seed` (`Ran 26`) + `parl-test-liberty-restrictions` (`Ran 100`, `OK (skipped=1)`). Evidencia en `docs/etl/sprints/AI-OPS-169/reports/sanction-norms-vote-lineage-bridge-coverage-expansion.md`.
- Slice AI-OPS-170 (normativa/cierre parcial con puente mixto de lineage en voto): `scripts/backfill_sanction_norms_vote_evidence.py` añade bridge conservador `lineage_shared_related_norm_mixed_relation` (ancla compartida con relación mixta `deroga` vs `desarrolla|modifica`) y `tests/test_backfill_sanction_norms_vote_evidence.py` suma regresión dedicada para ese path. Corrida (`20260224T093142Z`): parlamentario `candidate_matches_total=2`, `evidence_updated=2`; voto `candidate_matches_total=71`, `evidence_inserted=2`, `evidence_updated=121` con método nuevo observado `title_rule:rdl_6_2015_trafico_seguridad_vial+lineage_shared_related_norm_mixed_relation`; status `ok` con `responsibility_evidence_items_total=97`, `responsibilities_with_parliamentary_evidence_total=13/15`, `responsibilities_with_parliamentary_vote_evidence_total=13/15`, `responsibility_parliamentary_coverage_pct=0.866667`, `responsibility_parliamentary_vote_coverage_pct=0.866667`, ejecución estable `15/15`, `queue_rows_total=0`, `PRAGMA foreign_key_check` limpio; tests `parl-test-sanction-norms-seed` (`Ran 27`) + `parl-test-liberty-restrictions` (`Ran 100`, `OK (skipped=1)`). Gap residual acotado a `BOE-A-2000-15060` (`approve/enforce`). Evidencia en `docs/etl/sprints/AI-OPS-170/reports/sanction-norms-vote-lineage-mixed-bridge-closure.md`.
- Slice AI-OPS-171 (normativa/cierre parlamentario por regla de título LISOS): `scripts/backfill_sanction_norms_parliamentary_evidence.py` añade fallback conservador `title_rule:lisos_orden_social` para `BOE-A-2000-15060` cuando no hay token `BOE-A-*` explícito en `text_excerpt`, más observabilidad (`docs_with_title_rule_match_total`, `by_method`) y regresión en `tests/test_backfill_sanction_norms_parliamentary_evidence.py`. Corrida (`20260224T094041Z`): parlamentario `candidate_matches_total=3`, `evidence_inserted=2`, `evidence_updated=2`, `docs_with_title_rule_match_total=1` (`title_rule:lisos_orden_social=1`); voto se mantiene (`candidate_matches_total=71`, `evidence_inserted=0`, `evidence_updated=123`). Status `ok` con `responsibility_evidence_items_total=99`, `responsibilities_with_parliamentary_evidence_total=15/15`, `responsibilities_with_parliamentary_vote_evidence_total=13/15`, `responsibility_parliamentary_coverage_pct=1.0`, `responsibility_parliamentary_vote_coverage_pct=0.866667`, ejecución estable `15/15`, `queue_rows_total=0`, `PRAGMA foreign_key_check` limpio; tests `parl-test-sanction-norms-seed` (`Ran 28`) + `parl-test-liberty-restrictions` (`Ran 100`, `OK (skipped=1)`). Gap residual: voto en `BOE-A-2000-15060` (`approve/enforce`). Evidencia en `docs/etl/sprints/AI-OPS-171/reports/sanction-norms-parliamentary-title-rule-closure.md`.
- Slice AI-OPS-172 (normativa/diagnóstico estricto del gap residual de voto): se añade `scripts/report_sanction_norms_vote_gap_diagnosis.py` con lane reproducible `parl-report-sanction-norms-vote-gap-diagnosis` y regresión en `tests/test_report_sanction_norms_vote_gap_diagnosis.py` para separar explícitamente “sin matcher” vs “sin linkage upstream” en responsabilidades sin `congreso_vote/senado_vote`. Corrida (`20260224T094824Z`): `responsibilities_missing_vote_total=2` (ambas en `BOE-A-2000-15060`, roles `approve/enforce`), `missing_with_vote_title_candidates_total=0`, `missing_with_vote_doc_candidates_total=0`, diagnóstico `no_vote_event_link_for_parliamentary_initiatives` para `senado:leg5:exp:621/000026`; status del diagnóstico `degraded` con cola visible (`responsibility_vote_gap_*.csv`). Evidencia en `docs/etl/sprints/AI-OPS-172/reports/sanction-norms-vote-gap-diagnosis.md`.
- Slice AI-OPS-173 (garantías procedimentales/lane oficial TEAR-TEAC-contencioso-defensor): se amplía `etl/data/seeds/sanction_data_catalog_seed_v1.json` con cuatro fuentes oficiales nuevas (`es:sanctions:tear_resolutions`, `es:sanctions:teac_resolutions`, `es:sanctions:contencioso_sentencias`, `es:sanctions:defensor_pueblo_quejas`) y se añade `scripts/report_sanction_procedural_official_review_status.py` para medir cobertura operativa + cola accionable (`missing_source/no_metrics/no_source_record_chain`) con export CSV. `justfile` incorpora lane nuevo `parl-report-sanction-procedural-official-review-status`, lo integra en `parl-sanction-data-catalog-pipeline` y añade prueba `tests/test_report_sanction_procedural_official_review_status.py` a `parl-test-sanction-data-catalog`. Corrida (`20260224T095551Z`): catálogo `ok` con `volume_sources_total=9` (`volume_sources_inserted=4`), lane oficial `degraded` con seed `4/4` (`official_review_source_seed_coverage_pct=1.0`) y métricas `0/4` (`official_review_source_metric_coverage_pct=0.0`), cola accionable `4` filas (`next_action=ingest_official_review_procedural_metrics`); tests `parl-test-sanction-data-catalog` (`Ran 8`) y `parl-test-sanction-volume-pilot` (`Ran 5`) en verde. Evidencia en `docs/etl/sprints/AI-OPS-173/reports/sanction-procedural-official-review-lane-bootstrap.md`.
- Slice AI-OPS-174 (garantías procedimentales/apply loop CSV->DB para métricas oficiales): se añade `scripts/apply_sanction_procedural_official_review_metrics.py` con validación estricta de contrato (`sanction_source_id/kpi_id/period_date/source_url/value`), chequeos FK (`sanction_volume_sources`, `sanction_procedural_kpi_definitions`, `sources`), soporte `--dry-run/--strict`, autoresolución/autocreación de `source_record_pk` y upsert idempotente por `metric_key`. `justfile` incorpora `parl-apply-sanction-procedural-official-review-metrics` + `...-dry-run` y `parl-test-sanction-data-catalog` añade `tests/test_apply_sanction_procedural_official_review_metrics.py`. Corrida (`20260224T100608Z`): dry-run estricto sobre fixture de `4` fuentes (`rows_seen=4`, `rows_ready=4`, `skipped_*=0`, `source_record_pk_would_create=4`), tests `parl-test-sanction-data-catalog` (`Ran 10`) y unittest focal (`Ran 2`) en verde. El estado operativo permanece `degraded` (`official_review_source_metric_coverage_pct=0.0`) porque la corrida fue de validación sin carga efectiva. Evidencia en `docs/etl/sprints/AI-OPS-174/reports/sanction-procedural-official-review-apply-loop-bootstrap.md`.
- Slice AI-OPS-175 (garantías procedimentales/template export para captura manual): se añade `scripts/export_sanction_procedural_official_review_apply_template.py` para generar CSV prellenado (`fuente oficial x KPI`) compatible con el apply estricto (`AI-OPS-174`), con `metric_key`, `source_record_id`, `source_url` y metadatos de fórmula/target; soporta `--only-missing` para evitar filas ya cargadas. `justfile` incorpora lane `parl-export-sanction-procedural-official-review-apply-template` y `parl-test-sanction-data-catalog` suma `tests/test_export_sanction_procedural_official_review_apply_template.py`. Corrida (`20260224T100945Z`): export `ok` con `sources_seeded_total=4`, `kpis_total=3`, `rows_emitted_total=12`, `rows_skipped_existing_total=0`; tests `parl-test-sanction-data-catalog` (`Ran 12`) y unittest focal (`Ran 2`) en verde. Estado lane oficial sigue `degraded` (`official_review_source_metric_coverage_pct=0.0`) hasta aplicar métricas oficiales validadas. Evidencia en `docs/etl/sprints/AI-OPS-175/reports/sanction-procedural-official-review-template-export-lane.md`.
- Slice AI-OPS-176 (garantías procedimentales/readiness gate previo a apply): se añade `scripts/report_sanction_procedural_official_review_apply_readiness.py` para validar el CSV antes de cargar (`headers requeridos`, IDs contra DB, coerción/rangos numéricos, coherencia de fórmula en ratios con tolerancia configurable y cola accionable exportable por fila/razón). `justfile` incorpora lane `parl-check-sanction-procedural-official-review-apply-readiness` con modo `--strict`; `parl-test-sanction-data-catalog` suma `tests/test_report_sanction_procedural_official_review_apply_readiness.py`. Corrida (`20260224T101432Z`): sobre template vacío (`AI-OPS-175`) reporta `status=degraded` con `rows_seen=12`, `rows_ready=0`, `rows_blocked=12` (`missing_required_field=12`, `missing_ratio_components=8`) y cola CSV; sobre fixture completo (`AI-OPS-174`) en strict reporta `status=ok` con `rows_ready=4/4`, `rows_blocked=0`. Tests en verde: `parl-test-sanction-data-catalog` (`Ran 15`) + unittest focal (`Ran 3`). Estado lane oficial de métricas sigue `degraded` (`official_review_source_metric_coverage_pct=0.0`) hasta aplicar datos oficiales validados. Evidencia en `docs/etl/sprints/AI-OPS-176/reports/sanction-procedural-official-review-apply-readiness-gate.md`.
- Slice AI-OPS-177 (garantías procedimentales/ciclo estricto unificado de carga): se añade `scripts/run_sanction_procedural_official_review_apply_cycle.py` para ejecutar `readiness -> apply -> status` en una sola corrida reproducible, con bloqueo duro en `--strict-readiness` (exit `4` cuando readiness no es `ok`). `justfile` actualiza `parl-apply-sanction-procedural-official-review-metrics` y `...-dry-run` para usar el ciclo unificado; `parl-test-sanction-data-catalog` suma `tests/test_run_sanction_procedural_official_review_apply_cycle.py`. Corrida (`20260224T101854Z`): ruta template vacío bloqueada como esperado (`exit_code=4`, readiness `degraded`, apply `skipped=readiness_not_ok`); ruta fixture completo en dry-run pasa (`readiness=ok`, `rows_ready=4`, `rows_upserted=0`, `source_record_pk_would_create=4`). Tests en verde: `parl-test-sanction-data-catalog` (`Ran 17`) + unittest ciclo (`Ran 2`). Estado lane oficial en DB staging permanece `degraded` (`official_review_source_metric_coverage_pct=0.0`) hasta aplicar datos oficiales reales. Evidencia en `docs/etl/sprints/AI-OPS-177/reports/sanction-procedural-official-review-apply-cycle-gate.md`.
- Slice AI-OPS-178 (garantías procedimentales/prepare incremental de input): se añade `scripts/prepare_sanction_procedural_official_review_apply_input.py` para filtrar filas vacías o sin metadatos mínimos del template oficial antes de apply, con export reproducible de `prepared.csv` + cola `rejected.csv` (`_csv_line/_reason`) y modo `--strict` (`exit=4` si `status!=ok`). `justfile` incorpora lane `parl-prepare-sanction-procedural-official-review-apply-input` y variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PREPARE_*`; `parl-test-sanction-data-catalog` suma `tests/test_prepare_sanction_procedural_official_review_apply_input.py`. Corrida (`20260224T102145Z`): template `degraded` (`rows_seen=12`, `rows_kept=0`, `rows_rejected=12`) y fixture `ok` (`rows_seen=4`, `rows_kept=4`, `rows_rejected=0`). Estado lane oficial se mantiene `degraded` (`official_review_source_metric_coverage_pct=0.0`) al no aplicar carga real en este slice. Evidencia en `docs/etl/sprints/AI-OPS-178/reports/sanction-procedural-official-review-apply-input-prepare-lane.md`.
- Slice AI-OPS-179 (garantías procedimentales/unificación `prepare -> cycle`): se añade `scripts/run_sanction_procedural_official_review_prepare_apply_cycle.py` para ejecutar en una sola corrida `prepare -> readiness -> apply -> status`, con gate `--strict-prepare` que bloquea temprano (`skip_reason=prepare_not_ok`, exit `4`) cuando no hay filas listas. Se refactoriza `scripts/run_sanction_procedural_official_review_apply_cycle.py` para exponer `run_cycle(...)` reutilizable sin duplicación, y `justfile` suma lanes `parl-run-sanction-procedural-official-review-prepare-apply-cycle` + `...-dry-run` con variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PREPARE_CYCLE_*`; `parl-test-sanction-data-catalog` sube a `Ran 22` añadiendo `tests/test_run_sanction_procedural_official_review_prepare_apply_cycle.py`. Corrida (`20260224T102733Z`): template vacío bloqueado (`prepare=degraded`, `rows_kept=0/12`, `exit=4`) y fixture completo en dry-run pasa (`prepare=ok`, `readiness=ok`, `rows_ready=4`, `rows_upserted=0`, `source_record_pk_would_create=4`). Estado lane oficial sigue `degraded` (`official_review_source_metric_coverage_pct=0.0`) hasta carga oficial real. Evidencia en `docs/etl/sprints/AI-OPS-179/reports/sanction-procedural-official-review-prepare-apply-cycle-lane.md`.
- Slice AI-OPS-180 (garantías procedimentales/gate de trazabilidad de evidencia): se endurece el contrato de métricas oficiales exigiendo evidencia explícita por fila (`evidence_date`, `evidence_quote`) en todo el loop `prepare -> readiness -> apply -> status`. Se añaden columnas aditivas en `sanction_procedural_metrics` (`etl/load/sqlite_schema.sql` + `ensure_schema_compat` en `etl/politicos_es/db.py`), validaciones nuevas en apply/readiness (`YYYY-MM-DD` y longitud mínima de cita), y export de template con columnas de evidencia. `report_sanction_procedural_official_review_status.py` incorpora cobertura de evidencia (`official_review_metric_rows_with_evidence_total`, `official_review_metric_rows_missing_evidence_total`, `official_review_evidence_coverage_pct`) y nuevo estado de cola `no_evidence_chain` con acción `backfill_evidence_date_quote_for_official_review_metrics`; además mantiene compatibilidad con DBs viejas sin columnas. Corrida (`20260224T104009Z`): template bloqueado en strict (`exit=4`, `rows_kept=0/12`, `skip_reason=prepare_not_ok`) y fixture completo en dry-run pasa (`prepare=ok`, `readiness=ok`, `rows_ready=4`, `rows_upserted=0`, `source_record_pk_would_create=4`). Suite `parl-test-sanction-data-catalog` sube a `Ran 23` y permanece en verde. Estado lane oficial en staging sigue `degraded` (`official_review_source_metric_coverage_pct=0.0`, `official_review_evidence_coverage_pct=0.0`) por falta de carga oficial real. Evidencia en `docs/etl/sprints/AI-OPS-180/reports/sanction-procedural-official-review-evidence-traceability-gate.md`.
- Slice AI-OPS-181 (garantías procedimentales/transformador `raw -> KPI` para carga oficial): se añade `scripts/export_sanction_procedural_official_review_apply_from_raw_metrics.py` para convertir una fila raw por fuente (`recurso_presentado_count`, `recurso_estimado_count`, `anulaciones_formales_count`, `resolution_delay_p90_days`) en tres filas `apply-ready` (`recurso_estimation_rate`, `formal_annulment_rate`, `resolution_delay_p90_days`) con `metric_key`, `source_record_id` por KPI y trazabilidad de evidencia (`evidence_date/evidence_quote`, `raw_row_key`). El transformador incorpora validaciones duras (headers, fecha evidencia, cita mínima, counts numéricos, `presentados>0`, `p90>0`, componentes no negativos, ratio en `[0,1]`, no duplicar `metric_key`) y cola de rechazo reproducible por fila/razón. `justfile` suma lane `parl-export-sanction-procedural-official-review-apply-from-raw` y variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_RAW_*`; `parl-test-sanction-data-catalog` sube a `Ran 26` con `tests/test_export_sanction_procedural_official_review_apply_from_raw_metrics.py`. Corrida (`20260224T104837Z`): transformador `status=ok` (`rows_seen=4`, `rows_emitted=4`, `kpi_rows_emitted=12`, `rows_rejected=0`), readiness `ok` (`rows_ready=12/12`) y ciclo unificado en dry-run `ok` (`source_record_pk_would_create=12`). El estado lane oficial en staging se mantiene `degraded` (`official_review_procedural_metrics_total=0`) al no aplicar carga real en este slice. Evidencia en `docs/etl/sprints/AI-OPS-181/reports/sanction-procedural-official-review-raw-to-kpi-transformer.md`.
- Slice AI-OPS-182 (garantías procedimentales/orquestador unificado `raw -> prepare -> apply`): se añade `scripts/run_sanction_procedural_official_review_raw_prepare_apply_cycle.py` para ejecutar en una sola corrida el flujo completo desde CSV raw por fuente hasta status final (`raw transform -> prepare -> readiness -> apply -> status`) con gates estrictos por etapa (`--strict-raw`, `--strict-prepare`, `--strict-readiness`). El script bloquea tempranamente con `skip_reason=raw_not_ok` cuando la captura raw no cumple contrato, y mantiene salida consolidada auditable (`raw`, `prepare`, `cycle`) más artefactos intermedios CSV/JSON. `justfile` incorpora lanes `parl-run-sanction-procedural-official-review-raw-prepare-apply-cycle` + `...-dry-run` y variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_RAW_CYCLE_*`; `parl-test-sanction-data-catalog` sube a `Ran 28` con `tests/test_run_sanction_procedural_official_review_raw_prepare_apply_cycle.py`. Corrida (`20260224T105455Z`): pass-path dry-run con `4` fuentes (`raw.rows_emitted=4`, `kpi_rows_emitted=12`, `prepare=ok`, `readiness=ok`, `source_record_pk_would_create=12`) y fail-path estricto reproducible (`exit=4`, `raw.status=degraded`, `skip_reason=raw_not_ok`). Estado lane oficial en staging sigue `degraded` (`official_review_procedural_metrics_total=0`) por ausencia de carga oficial real en el slice. Evidencia en `docs/etl/sprints/AI-OPS-182/reports/sanction-procedural-official-review-raw-prepare-apply-cycle-lane.md`.
- Slice AI-OPS-183 (garantías procedimentales/template raw por fuente): se añade `scripts/export_sanction_procedural_official_review_raw_template.py` para exportar CSV de captura `1 fuente -> 1 fila` (TEAR/TEAC/contencioso/defensor) con prefills operativos (`source_url`, `source_id`, `source_record_id`, `expected_metrics`, `procedural_kpis_expected`, cobertura actual por fuente en el periodo) y campos raw obligatorios listos para completar (`recurso_presentado_count`, `recurso_estimado_count`, `anulaciones_formales_count`, `resolution_delay_p90_days`, `evidence_date`, `evidence_quote`). Soporta `--only-missing` para omitir fuentes ya cubiertas por KPIs en el periodo. `justfile` incorpora lane `parl-export-sanction-procedural-official-review-raw-template` y variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_RAW_TEMPLATE_*`; `parl-test-sanction-data-catalog` sube a `Ran 30` con `tests/test_export_sanction_procedural_official_review_raw_template.py`. Corrida (`20260224T105932Z`): template `status=ok` (`sources_expected=4`, `sources_seeded=4`, `rows_emitted=4`) y verificación de gate estricto sobre template vacío (`parl-run-...raw-prepare-apply-cycle-dry-run`, `exit=4`, `raw.status=degraded`, `skip_reason=raw_not_ok`) confirmando bloqueo temprano reproducible hasta completar captura real. Estado lane oficial en staging sigue `degraded` (`official_review_procedural_metrics_total=0`) por no aplicar carga real en el slice. Evidencia en `docs/etl/sprints/AI-OPS-183/reports/sanction-procedural-official-review-raw-template-lane.md`.
- Slice AI-OPS-184 (garantías procedimentales/gate de completitud KPI por periodo): `scripts/report_sanction_procedural_official_review_status.py` incorpora scope opcional por periodo (`--period-date`, `--period-granularity`) y distingue cobertura parcial de KPI por fuente (`partial_kpi_coverage`) frente a “tiene métricas”. Se añaden métricas/checks de completitud (`official_review_kpis_expected_total`, `official_review_sources_with_all_kpis_total`, `official_review_sources_with_missing_kpis_total`, `official_review_missing_kpi_pairs_total`, `official_review_source_full_kpi_coverage_pct`, check `official_review_all_seeded_have_all_kpis`) y la cola CSV añade `kpis_expected_total/kpis_missing_total`. `justfile` habilita estos filtros vía `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_STATUS_PERIOD_DATE` y `..._PERIOD_GRANULARITY` en `parl-report-sanction-procedural-official-review-status`. Tests de status suben a `Ran 6` con dos casos nuevos (cobertura parcial + aislamiento por periodo) y `parl-test-sanction-data-catalog` sube a `Ran 32`. Corrida (`20260224T110525Z`): staging en scope `2025-12-31/year` permanece `degraded` con `sources_with_metrics=0`, `sources_with_all_kpis=0`, `kpis_expected_total=3`, `missing_kpi_pairs_total=12`; fixture contractual confirma estado `partial_kpi_coverage` cuando una fuente cubre `2/3` KPIs manteniendo cadena `source_record/evidence` completa. Evidencia en `docs/etl/sprints/AI-OPS-184/reports/sanction-procedural-official-review-kpi-completeness-period-scope.md`.
- Slice AI-OPS-185 (garantías procedimentales/cola accionable por par `fuente x KPI`): se añade `scripts/export_sanction_procedural_official_review_kpi_gap_queue.py` para exportar una cola de remediación a nivel par (`4 fuentes x 3 KPIs`) con estado determinista por fila (`missing_source`, `missing_metric`, `missing_source_record`, `missing_evidence`, `ready`), `queue_key` estable, `metric_key_expected`, prioridad y `next_action`. Soporta scope temporal (`--period-date`, `--period-granularity`), `--include-ready`, límite de cola y gate `--strict-empty`; `justfile` incorpora lane `parl-export-sanction-procedural-official-review-kpi-gap-queue` (variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_KPI_GAP_*`), lo integra en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 35` con `tests/test_export_sanction_procedural_official_review_kpi_gap_queue.py`. Corrida (`20260224T111300Z`): staging en scope `2025-12-31/year` queda `degraded` con `expected_pairs_total=12`, `pairs_missing_metric_total=12`, `queue_rows_total=12`; fixture contractual mixto confirma discriminación por par (`pairs_ready_total=1`, `pairs_missing_metric_total=9`, `pairs_missing_source_record_total=1`, `pairs_missing_evidence_total=1`). Evidencia en `docs/etl/sprints/AI-OPS-185/reports/sanction-procedural-official-review-kpi-gap-queue.md`.
- Slice AI-OPS-186 (garantías procedimentales/plantilla de remediación `apply` desde cola KPI): se añade `scripts/export_sanction_procedural_official_review_apply_from_kpi_gap_queue.py` para convertir la cola `source x KPI` en CSV `apply-ready` con contexto operativo (`queue_status/priority/next_action`), filtros por estado (`--statuses`), scope temporal, `--include-ready` y gate `--strict-actionable`. La exportación prellena automáticamente filas con cadena parcial (`missing_source_record`/`missing_evidence`) leyendo métricas existentes (`value/numerator/denominator/source_record_pk/source_record_id`) y deja vacías solo las filas realmente faltantes (`missing_metric`). `justfile` incorpora lane `parl-export-sanction-procedural-official-review-apply-from-kpi-gap-queue` + variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_APPLY_FROM_GAP_*`, lo integra en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 38` con `tests/test_export_sanction_procedural_official_review_apply_from_kpi_gap_queue.py`. Corrida (`20260224T112006Z`): staging (`2025-12-31/year`) exporta `12` filas (`missing_metric=12`), fixture contractual mixto confirma prefill por estado (`rows=11`, `missing_metric=9`, `missing_source_record=1`, `missing_evidence=1`) y pipeline integrado (`just parl-sanction-data-catalog-pipeline`) queda en verde. Evidencia en `docs/etl/sprints/AI-OPS-186/reports/sanction-procedural-official-review-apply-from-kpi-gap-queue.md`.
- Slice AI-OPS-187 (garantías procedimentales/ciclo automático desde cola KPI a apply): se añade `scripts/run_sanction_procedural_official_review_apply_from_kpi_gap_cycle.py` para ejecutar en una sola corrida `gap-export -> readiness/apply/status`, con filtros por estado (`--statuses`, default operativo `missing_source_record`), scope temporal, gate `--strict-actionable` y salida consolidada (`gap_export`, `cycle`). El ciclo salta explícitamente con `skip_reason=no_actionable_rows` cuando no hay filas del estado objetivo, evitando intentos ciegos. `justfile` incorpora lanes `parl-run-sanction-procedural-official-review-apply-from-kpi-gap-cycle` + `...-dry-run` y variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_GAP_CYCLE_*`; `parl-test-sanction-data-catalog` sube a `Ran 41` con `tests/test_run_sanction_procedural_official_review_apply_from_kpi_gap_cycle.py`. Corrida (`20260224T112750Z`): staging en `2025-12-31/year` (solo `missing_source_record`) queda en `degraded` con `rows_emitted_total=0` y `skip_reason=no_actionable_rows`; fixture contractual con `1` fila `missing_source_record` ejecuta apply completo (`rows_ready=1`, `rows_upserted=1`) cerrando cadena `source_record_pk` sin manipulación manual. Evidencia en `docs/etl/sprints/AI-OPS-187/reports/sanction-procedural-official-review-apply-from-kpi-gap-cycle.md`.
- Slice AI-OPS-188 (garantías procedimentales/paquetes raw por fuente desde cola KPI): se añade `scripts/export_sanction_procedural_official_review_raw_packets_from_kpi_gap_queue.py` para convertir la cola accionable de gaps KPI en paquetes CSV raw por fuente (`1` archivo por `sanction_source_id`) listos para captura manual y posterior ciclo `raw -> prepare -> apply`. El lane soporta scope temporal, filtro por estado (`--statuses`, default `missing_metric`), `--include-ready`, `--strict-actionable`, y produce resumen JSON con checks de completitud (`packets_complete_for_actionable_sources`) y preview de KPIs faltantes por fuente. `justfile` incorpora lane `parl-export-sanction-procedural-official-review-raw-packets-from-kpi-gap-queue` + variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_RAW_PACKETS_*`, lo integra en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 44` con `tests/test_export_sanction_procedural_official_review_raw_packets_from_kpi_gap_queue.py`. Corrida (`20260224T113504Z` directo, `20260224T113514Z` vía `just`) en `2025-12-31/year`: `queue_rows_seen_total=12`, `sources_actionable_total=4`, `packets_emitted_total=4`, `sources_skipped_missing_template_total=0`; cada fuente queda con `3` KPIs faltantes (`formal_annulment_rate`, `recurso_estimation_rate`, `resolution_delay_p90_days`) en paquete independiente, sin pasos manuales de particionado. Evidencia en `docs/etl/sprints/AI-OPS-188/reports/sanction-procedural-official-review-raw-packets-from-kpi-gap-queue.md`.
- Slice AI-OPS-189 (garantías procedimentales/lane unificado `packet-dir -> raw cycle`): se añade `scripts/run_sanction_procedural_official_review_raw_packets_cycle.py` para cerrar el salto operativo entre paquetes por fuente (`AI-OPS-188`) y el ciclo estricto de carga (`raw -> prepare -> readiness -> apply`) sin ensamblado manual de CSV. El lane valida cobertura de paquetes esperados contra cola KPI (`build_raw_packets_from_gap_queue`), fusiona filas en raw consolidado, y ejecuta `run_sanction_procedural_official_review_raw_prepare_apply_cycle.py` con gates explícitos (`--strict-actionable`, `--strict-packet-coverage`, passthrough `--strict-raw/--strict-prepare/--strict-readiness`) y skips reproducibles (`no_actionable_packets`, `missing_packet_files`, `invalid_packet_headers`, `no_packet_rows`). `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_RAW_PACKETS_CYCLE_*`, lanes `parl-run-sanction-procedural-official-review-raw-packets-cycle` + `...-dry-run`, integra la corrida dry-run en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 47` con `tests/test_run_sanction_procedural_official_review_raw_packets_cycle.py`. Corridas (`20260224T114727Z` directa, `20260224T114738Z` vía `just`) con paquetes staging detectan `4/4` archivos y `4` filas raw; sobre plantillas vacías el ciclo queda `raw=degraded` y `rows_ready=0` (esperado), y fixture estricto (`20260224T114814Z`) confirma pass-path completo (`raw=ok`, `prepare=ok`, `readiness=ok`, `rows_ready=12` en dry-run). Evidencia en `docs/etl/sprints/AI-OPS-189/reports/sanction-procedural-official-review-raw-packets-cycle-lane.md`.
- Slice AI-OPS-190 (garantías procedimentales/checkpoint de readiness por paquete): se añade `scripts/report_sanction_procedural_official_review_raw_packets_progress.py` para medir por fuente si los paquetes raw exportados desde la cola KPI están realmente listos para transformar/cargar. El lane cruza paquetes esperados (`build_raw_packets_from_gap_queue`) con el contenido real de `--packets-dir`, clasifica estados deterministas (`missing_packet_file`, `invalid_headers`, `empty_packet`, `multiple_rows`, `invalid_row`, `ready`), y expone por fila `missing_required_fields` y `row_reject_reasons` (contrato de `build_apply_rows`) antes de correr `raw -> prepare -> apply`. `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_RAW_PACKETS_PROGRESS_*`, lane `parl-report-sanction-procedural-official-review-raw-packets-progress`, integración en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 50` con `tests/test_report_sanction_procedural_official_review_raw_packets_progress.py`. Corridas (`20260224T115621Z` sobre `AI-OPS-188/latest`) muestran cobertura de archivos completa pero `0/4 ready` (`invalid_row` por métricas/evidencia vacías), y fixture contractual (`20260224T115600Z`, `--strict-ready`) valida pass-path `4/4 ready`; pipeline integrado permanece en verde (`20260224T115636Z`). Evidencia en `docs/etl/sprints/AI-OPS-190/reports/sanction-procedural-official-review-raw-packets-progress-lane.md`.
- Slice AI-OPS-191 (garantías procedimentales/ciclo incremental por paquetes listos): se añade `scripts/run_sanction_procedural_official_review_ready_packets_cycle.py` para ejecutar el ciclo `raw -> prepare -> readiness -> apply` únicamente con paquetes `ready`, permitiendo avance parcial sin esperar a que todas las fuentes estén completas. El lane reutiliza diagnóstico de readiness (`build_raw_packets_progress_report`), selecciona subset por fuente listo para transformar y preserva gates explícitos (`--strict-actionable`, `--strict-min-ready` + `--min-ready-packets`, passthrough `--strict-raw/--strict-prepare/--strict-readiness`) con skips reproducibles (`no_actionable_packets`, `no_ready_packets`, `ready_packets_below_minimum`). `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_READY_PACKETS_CYCLE_*`, lanes `parl-run-sanction-procedural-official-review-ready-packets-cycle` + `...-dry-run`, integración en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 53` con `tests/test_run_sanction_procedural_official_review_ready_packets_cycle.py`. Corrida `20260224T120343Z` en staging (`AI-OPS-188/latest`, `2026-02-12/year`) confirma skip explícito `no_ready_packets` (`ready=0/4`); fixture contractual del mismo timestamp (`AI-OPS-189` paquete completo) valida pass-path estricto en dry-run (`ready_selected=4`, `raw=ok`, `prepare=ok`, `readiness=ok`, `rows_ready=12`). Evidencia en `docs/etl/sprints/AI-OPS-191/reports/sanction-procedural-official-review-ready-packets-cycle-lane.md`.
- Slice AI-OPS-192 (garantías procedimentales/cola priorizada de remediación de paquetes): se añade `scripts/export_sanction_procedural_official_review_packet_fix_queue.py` para convertir el diagnóstico de paquetes no listos en una cola operativa priorizada por fuente, con `next_action` explícita y razones de bloqueo por fila (`missing_required_fields`, `row_reject_reasons`). El lane clasifica y prioriza estados (`missing_packet_file`, `invalid_headers`, `multiple_rows`, `empty_packet`, `invalid_row`), mantiene trazabilidad por `queue_key` y soporta gate `--strict-empty` para exigir backlog cero cuando corresponda. `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_*`, lane `parl-export-sanction-procedural-official-review-packet-fix-queue`, integración en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 56` con `tests/test_export_sanction_procedural_official_review_packet_fix_queue.py`. Corrida `20260224T120848Z`: staging (`AI-OPS-188/latest`, `2026-02-12/year`) devuelve `queue_rows_total=4` (`invalid_row=4`) con acción homogénea `complete_evidence_and_raw_count_fields_then_recheck`; fixture contractual (`AI-OPS-189` paquete completo) confirma cola vacía (`queue_rows_total=0`, `fix_queue_empty=true`). Evidencia en `docs/etl/sprints/AI-OPS-192/reports/sanction-procedural-official-review-packet-fix-queue-lane.md`.
- Slice AI-OPS-193 (garantías procedimentales/bridge remediación->carga incremental): se añade `scripts/run_sanction_procedural_official_review_packet_fix_ready_cycle.py` para unificar en una sola corrida `packet-fix-queue -> ready-packets-cycle`, con skip explícito cuando no hay paquetes listos y pass-path automático cuando sí los hay. `justfile` incorpora lanes `parl-run-sanction-procedural-official-review-packet-fix-ready-cycle` + `...-dry-run` (variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_READY_CYCLE_*`), integración en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 59` con `tests/test_run_sanction_procedural_official_review_packet_fix_ready_cycle.py`. Corridas (`20260224T122017Z` staging `AI-OPS-188/latest`, `2026-02-12/year`) y (`20260224T122029Z` fixture `AI-OPS-189`, `2025-12-31/year`) validan ambos caminos: staging `fix_queue.status=degraded`, `queue_rows_total=4`, `ready_packets_selected_total=0`, `skip_reason=no_ready_packets`; fixture strict dry-run `fix_queue.status=ok`, `queue_rows_total=0`, `ready_packets_selected_total=4`, `raw/prepare/readiness=ok`, `rows_ready=12`. Pipeline integrado `just parl-sanction-data-catalog-pipeline` pasa (`20260224T122047Z`). Evidencia en `docs/etl/sprints/AI-OPS-193/reports/sanction-procedural-official-review-packet-fix-ready-cycle-lane.md`.
- Slice AI-OPS-194 (garantías procedimentales/heartbeat de backlog packet-fix): se añaden `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat.py` y `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_window.py` para registrar latidos append-only del estado de remediación (`docs/etl/runs/sanction_procedural_official_review_packet_fix_queue_heartbeat.jsonl`) y validar tendencia de ventana (`failed/degraded/nonempty_queue/malformed`) con umbrales configurables. `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-window`, integración en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 63` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat.py` + `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_window.py`. Corrida (`20260224T123410Z`): heartbeat `status=degraded` (`queue_rows_total=4`, `packets_ready_total=0`, `packets_not_ready_total=4`) con `strict_fail_reasons=[]`; ventana `status=ok` (`entries_in_window=2`, `failed_in_window=0`, `degraded_in_window=2`, `nonempty_queue_runs_in_window=2`, `strict_fail_reasons=[]`); pipeline integrado en verde. Evidencia en `docs/etl/sprints/AI-OPS-194/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-lane.md`.
- Slice AI-OPS-195 (garantías procedimentales/compacción de heartbeat packet-fix): se añaden `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction.py` y `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window.py` para compactar historial heartbeat con retención por tiers (`recent/mid/old`) y verificar paridad raw-vs-compacted en ventana (`latest/incidents/strict/malformed`). `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window`, integración en `parl-sanction-data-catalog-pipeline`, y cobertura dedicada en `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction.py` + `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window.py`. Corrida (`20260224T124757Z`): compaction `status=degraded` (`entries_total=6`, `selected_entries=6`, `dropped_entries=0`, `strict_fail_reasons=[]`) y compaction-window `status=ok` (`window_raw_entries=6`, `missing_in_compacted_in_window=0`, `strict_fail_reasons=[]`); pipeline integrado en verde. Evidencia en `docs/etl/sprints/AI-OPS-195/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-lane.md`.
- Slice AI-OPS-196 (garantías procedimentales/digest de paridad compaction-window): se añade `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest.py` para resumir la paridad en un contrato compacto (`status`, `risk_level`, `risk_reasons`, `key_metrics`) y validación strict reproducible. `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest`, e integra el check en `parl-sanction-data-catalog-pipeline`; `parl-test-sanction-data-catalog` sube a `Ran 70` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest.py`. Corrida (`20260224T124757Z`): digest `status=ok`, `risk_level=green`, `risk_reasons=[]`, `strict_fail_reasons=[]`, `raw_window_coverage_pct=100.0`, `incident_coverage_pct=100.0`; pipeline completo en verde. Evidencia en `docs/etl/sprints/AI-OPS-196/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-lane.md`.
- Slice AI-OPS-197 (garantías procedimentales/heartbeat temporal del digest de paridad): se añaden `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat.py` (append-only + dedupe por `heartbeat_id`) y `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_window.py` (ventana strict por `status`/`risk_level`). `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-window`, integración en `parl-sanction-data-catalog-pipeline`, y cobertura en `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat.py` + `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_window.py`; `parl-test-sanction-data-catalog` sube a `Ran 75`. Corrida (`20260224T125555Z`): digest `status=ok` (`window_raw_entries=8`, `missing_in_compacted_in_window=0`, `incident_missing_in_compacted=0`), heartbeat `status=ok` (`appended=true`, `history_size_before=1`, `history_size_after=2`) y ventana `status=ok` (`entries_in_window=2`, `status_counts.ok=2`, `risk_level_counts.green=2`, `strict_fail_reasons=[]`); pipeline completo en verde. Evidencia en `docs/etl/sprints/AI-OPS-197/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-lane.md`.
- Slice AI-OPS-198 (garantías procedimentales/compacción del digest-heartbeat de paridad): se añaden `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction.py` (retención determinista por tiers sobre la serie heartbeat del digest) y `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window.py` (paridad strict raw-vs-compacted en ventana). `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window`, integración en `parl-sanction-data-catalog-pipeline`, y cobertura en `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction.py` + `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window.py`; `parl-test-sanction-data-catalog` sube a `Ran 80`. Corrida (`20260224T130421Z`): compaction `status=degraded` (`entries_total=3`, `selected_entries=3`, `dropped_entries=0`, `strict_fail_reasons=[]`) y compaction-window `status=ok` (`window_raw_entries=3`, `missing_in_compacted_in_window=0`, `incident_missing_in_compacted=0`, `strict_fail_reasons=[]`); pipeline completo en verde. Evidencia en `docs/etl/sprints/AI-OPS-198/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-lane.md`.
- Slice AI-OPS-199 (garantías procedimentales/digest compacto de paridad sobre compaction-window del digest-heartbeat): se añade `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest.py` para resumir en contrato compacto (`status`, `risk_level`, `risk_reasons`, `strict_fail_reasons`, `key_metrics`) la paridad `raw-vs-compacted` del heartbeat ya compactado, con modo `--strict` reproducible. `justfile` incorpora variable `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_OUT`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest`, e integra el check en `parl-sanction-data-catalog-pipeline`; `parl-test-sanction-data-catalog` sube a `Ran 83` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest.py`. Corrida (`20260224T131205Z`): digest `status=ok`, `risk_level=green`, `risk_reasons=[]`, `strict_fail_reasons=[]`, `window_raw_entries=5`, `missing_in_compacted_in_window=0`, `incident_missing_in_compacted=0`, `raw_window_coverage_pct=100.0`; pipeline y tracker gate en verde. Evidencia en `docs/etl/sprints/AI-OPS-199/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-lane.md`.
- Slice AI-OPS-200 (garantías procedimentales/heartbeat append-only del digest compacto de paridad): se añade `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat.py` para registrar latidos deduplicados (`heartbeat_id`) sobre el contrato compacto de AI-OPS-199 y mantener trazabilidad temporal (`status/risk_level/reasons/key_metrics`) con gate `--strict`. `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat`, e integra el check en `parl-sanction-data-catalog-pipeline`; `parl-test-sanction-data-catalog` sube a `Ran 85` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat.py`. Corrida (`20260224T132030Z`): heartbeat `status=ok`, `risk_level=green`, `strict_fail_reasons=[]`, `window_raw_entries=8`, `missing_in_compacted_in_window=0`, `history_size_before=1`, `history_size_after=2`, `appended=true`; pipeline y tracker gate completos en verde. Evidencia en `docs/etl/sprints/AI-OPS-200/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-lane.md`.
- Slice AI-OPS-201 (garantías procedimentales/ventana strict del heartbeat compacto de paridad): se añade `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_window.py` para aplicar guardarraíl temporal `last N` sobre la serie append-only de AI-OPS-200 con umbrales estrictos de `failed/degraded` y fail-fast reproducible. `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_WINDOW_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-window` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-window`, integra el check en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 88` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_window.py`. Corrida (`20260224T132835Z`): ventana `status=ok`, `strict_fail_reasons=[]`, `entries_in_window=2`, `status_counts.ok=2`, `status_counts.failed=0`, `status_counts.degraded=0`, `risk_level_counts.green=2`; pipeline y tracker gate en verde. Evidencia en `docs/etl/sprints/AI-OPS-201/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-window-lane.md`.
- Slice AI-OPS-202 (garantías procedimentales/compacción del heartbeat compacto de paridad): se añaden `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction.py` (retención determinista por tiers sobre la serie heartbeat deduplicada de AI-OPS-200/201) y `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window.py` (paridad strict raw-vs-compacted en ventana sobre esa misma serie). `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window`, e integra ambos en `parl-sanction-data-catalog-pipeline`; `parl-test-sanction-data-catalog` sube a `Ran 93` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction.py` + `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window.py`. Corrida (`20260224T133440Z`): compaction `status=degraded` esperado por historial corto (`entries_total=3`, `selected_entries=3`, `dropped_entries=0`, `strict_fail_reasons=[]`) y compaction-window `status=ok` (`window_raw_entries=3`, `missing_in_compacted_in_window=0`, `latest_present_ok=true`, `strict_fail_reasons=[]`); pipeline y tracker gate en verde. Evidencia en `docs/etl/sprints/AI-OPS-202/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-lane.md`.
- Slice AI-OPS-203 (garantías procedimentales/digest compacto de la capa de compacción AI-OPS-202): se añade `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest.py` para resumir en contrato compacto strict (`status`, `risk_level`, `risk_reasons`, `strict_fail_reasons`, `key_metrics`) la salud de la nueva paridad `raw-vs-compacted` del heartbeat de continuidad. `justfile` incorpora variable `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_OUT`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest`, integra el check en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 96` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest.py`. Corrida (`20260224T133909Z`): digest `status=ok`, `risk_level=green`, `risk_reasons=[]`, `strict_fail_reasons=[]`, `entries_total_raw=4`, `entries_total_compacted=4`, `window_raw_entries=4`, `missing_in_compacted_in_window=0`, `raw_window_coverage_pct=100.0`; pipeline y tracker gate en verde. Evidencia en `docs/etl/sprints/AI-OPS-203/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-lane.md`.
- Slice AI-OPS-204 (garantías procedimentales/heartbeat append-only del digest compacto AI-OPS-203): se añade `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat.py` para registrar latidos deduplicados (`heartbeat_id`) sobre el contrato compacto de AI-OPS-203 y mantener continuidad temporal (`status/risk_level/strict_fail_reasons/key_metrics`) con gate `--strict`. `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat`, integra el check en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 98` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat.py`. Corrida (`20260224T134528Z`): heartbeat `status=ok`, `risk_level=green`, `strict_fail_reasons=[]`, `window_raw_entries=5`, `missing_in_compacted_in_window=0`, `history_size_before=1`, `history_size_after=1`, `appended=false`, `duplicate_detected=true`; pipeline y tracker gate en verde. Evidencia en `docs/etl/sprints/AI-OPS-204/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-lane.md`.
- Slice AI-OPS-205 (garantías procedimentales/ventana strict sobre continuidad digest-heartbeat AI-OPS-204): se añade `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_window.py` para validar `last N` filas del heartbeat deduplicado de AI-OPS-204 con umbrales explícitos de `failed/degraded` y fail-fast reproducible en `--strict`. `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_WINDOW_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-window` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-window`, integra el check en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 101` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_window.py`. Corrida (`20260224T135142Z`): ventana `status=ok`, `strict_fail_reasons=[]`, `entries_in_window=2`, `status_counts.ok=2`, `status_counts.failed=0`, `status_counts.degraded=0`, `risk_level_counts.green=2`, `latest.status=ok`; pipeline y tracker gate en verde. Evidencia en `docs/etl/sprints/AI-OPS-205/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-window-lane.md`.
- Slice AI-OPS-206 (garantías procedimentales/compacción de continuidad digest-heartbeat AI-OPS-204+205): se añaden `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction.py` (retención determinista por tiers sobre la serie heartbeat deduplicada de AI-OPS-204/205) y `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window.py` (paridad strict raw-vs-compacted en ventana sobre esa continuidad). `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window`, integra ambos en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 106` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction.py` + `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window.py`. Corrida (`20260224T135943Z`): compaction `status=degraded` esperado por historial corto (`entries_total=4`, `selected_entries=4`, `dropped_entries=0`, `strict_fail_reasons=[]`) y compaction-window `status=ok` (`window_raw_entries=4`, `present_in_compacted_in_window=4`, `missing_in_compacted_in_window=0`, `latest_present_ok=true`, `strict_fail_reasons=[]`); pipeline y tracker gate en verde. Evidencia en `docs/etl/sprints/AI-OPS-206/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-lane.md`.
- Slice AI-OPS-207 (garantías procedimentales/digest compacto de la continuidad compactada AI-OPS-206): se añade `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest.py` para resumir en contrato compacto strict la capa `compaction-window` de continuidad (`status`, `risk_level`, `risk_reasons`, `strict_fail_reasons`, `key_metrics`). `justfile` incorpora variable `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_OUT`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest`, integra el check en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 109` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest.py`. Corrida (`20260224T140703Z`): digest `status=ok`, `risk_level=green`, `strict_fail_reasons=[]`, `entries_total_raw=5`, `entries_total_compacted=5`, `window_raw_entries=5`, `missing_in_compacted_in_window=0`, `raw_window_coverage_pct=100.0`; pipeline y tracker gate en verde. Evidencia en `docs/etl/sprints/AI-OPS-207/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-lane.md`.
- Slice AI-OPS-208 (garantías procedimentales/heartbeat append-only del digest compacto AI-OPS-207): se añade `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat.py` para registrar continuidad temporal deduplicada (`heartbeat_id`) de la señal AI-OPS-207 con gate `--strict` en la misma corrida. `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat`, integra el check en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 111` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat.py`. Corrida (`20260224T141158Z`): heartbeat `status=ok`, `risk_level=green`, `strict_fail_reasons=[]`, `history_size_before=0`, `history_size_after=1`, `appended=true`, `duplicate_detected=false`, `window_raw_entries=5`, `missing_in_compacted_in_window=0`; pipeline y tracker gate en verde. Evidencia en `docs/etl/sprints/AI-OPS-208/evidence/` y lane report en `docs/etl/sprints/AI-OPS-208/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-lane.md`.
- Slice AI-OPS-209 (garantías procedimentales/ventana strict sobre continuidad digest-heartbeat AI-OPS-208): se añade `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_window.py` para validar `last N` filas del heartbeat deduplicado de AI-OPS-208 con umbrales explícitos de `failed/degraded` y fail-fast reproducible en `--strict`. `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_WINDOW_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-window` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-window`, integra el check en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 114` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_window.py`. Corrida (`20260224T141714Z`): ventana `status=ok`, `strict_fail_reasons=[]`, `entries_in_window=2`, `status_counts.ok=2`, `status_counts.failed=0`, `status_counts.degraded=0`, `risk_level_counts.green=2`, `latest.status=ok`; pipeline y tracker gate en verde. Evidencia en `docs/etl/sprints/AI-OPS-209/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-window-lane.md`.
- Slice AI-OPS-210 (garantías procedimentales/compacción de continuidad digest-heartbeat AI-OPS-208+209): se añaden `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction.py` (retención determinista por tiers sobre la serie heartbeat deduplicada de AI-OPS-208/209) y `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window.py` (paridad strict raw-vs-compacted en ventana sobre esa continuidad). `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window`, integra ambos en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 119` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction.py` + `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window.py`. Corrida (`20260224T142419Z`): compaction `status=degraded` esperado por historial corto (`entries_total=3`, `selected_entries=3`, `dropped_entries=0`, `strict_fail_reasons=[]`) y compaction-window `status=ok` (`entries_total_raw=3`, `entries_total_compacted=3`, `window_raw_entries=3`, `missing_in_compacted_in_window=0`, `latest_present_ok=true`, `strict_fail_reasons=[]`); pipeline y tracker gate en verde. Evidencia en `docs/etl/sprints/AI-OPS-210/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-lane.md`.
- Slice AI-OPS-211 (garantías procedimentales/digest compacto strict sobre continuidad compactada AI-OPS-210): se añade `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest.py` para resumir en contrato de bajo ruido (`status`, `risk_level`, `risk_reasons`, `strict_fail_reasons`, `key_metrics`) la paridad `compaction-window` de AI-OPS-210. `justfile` incorpora variable `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_OUT`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest`, integra el check en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 123` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest.py`. Durante validación se endurece además `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction.py` para no exigir descarte cuando `drop_candidates_total=0` (solo filas incident/anchor), con regresión en `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction.py` (`test_compaction_all_incidents_can_keep_all_without_drop_failure`). Corrida (`20260224T143642Z`): digest `status=ok`, `risk_level=green`, `strict_fail_reasons=[]`, `entries_total_raw=4`, `entries_total_compacted=4`, `window_raw_entries=4`, `missing_in_compacted_in_window=0`; pipeline y tracker gate en verde tras fix (`mismatches=0`, `done_zero_real=0`). Evidencia en `docs/etl/sprints/AI-OPS-211/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-lane.md`.
- Slice AI-OPS-212 (garantías procedimentales/heartbeat append-only del digest compacto AI-OPS-211): se añade `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat.py` para registrar continuidad temporal deduplicada (`heartbeat_id`) sobre el contrato compacto AI-OPS-211 con gate estricto en la misma ejecución. `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat`, integra el report lane en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 125` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat.py`. Corrida (`20260224T144655Z`): heartbeat `status=ok`, `risk_level=green`, `validation_errors=[]`, `strict_fail_count=0`, dedupe validado en check replay (`duplicate_detected=true`, `history_before=1`, `history_after=1`) y continuidad ampliada vía pipeline (`history_after=2` en ejecución integrada); tracker gate en verde (`mismatches=0`, `done_zero_real=0`). Evidencia en `docs/etl/sprints/AI-OPS-212/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-lane.md`.
- Slice AI-OPS-213 (garantías procedimentales/ventana strict sobre continuidad heartbeat AI-OPS-212): se añade `scripts/report_sanction_procedural_official_review_packet_fix_queue_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_compaction_window_digest_heartbeat_window.py` para validar `last N` filas del heartbeat deduplicado de AI-OPS-212 con umbrales explícitos de `failed/degraded` y fail-fast en `--strict`. `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_WINDOW_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-window` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-window`, integra el check en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 128` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_ai_ops_213_heartbeat_window.py` (alias corto por límite de longitud de nombre de archivo). Corrida (`20260224T145439Z`): ventana `status=ok`, `strict_fail_reasons=[]`, `entries_total=2`, `entries_in_window=2`, `status_counts.ok=2`, `status_counts.failed=0`, `status_counts.degraded=0`, `risk_level_counts.green=2`, `latest.status=ok`; pipeline y tracker gate en verde (`mismatches=0`, `done_zero_real=0`). Evidencia en `docs/etl/sprints/AI-OPS-213/reports/sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-window-lane.md`.
- Slice AI-OPS-214 (garantías procedimentales/compacción de continuidad heartbeat AI-OPS-212+213): se añaden `scripts/report_sanction_procedural_official_review_packet_fix_queue_ai_ops_214_heartbeat_compaction.py` y `scripts/report_sanction_procedural_official_review_packet_fix_queue_ai_ops_214_heartbeat_compaction_window.py` (alias corto por límite de longitud de nombre de archivo) para aplicar retención determinista por tiers sobre el heartbeat de AI-OPS-212 y validar paridad strict raw-vs-compacted en ventana. `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_WINDOW_DIGEST_HEARTBEAT_COMPACT_*`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction` + `parl-check-sanction-procedural-official-review-packet-fix-queue-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window-digest-heartbeat-compaction-window`, integra ambos en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 133` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_ai_ops_214_heartbeat_compaction.py` + `tests/test_report_sanction_procedural_official_review_packet_fix_queue_ai_ops_214_heartbeat_compaction_window.py`. Corrida (`20260224T150319Z` y `20260224T150329Z`): compaction `status=degraded` esperado por historial corto (`entries_total=3`, `selected_entries=3`, `dropped_entries=0`, `strict_fail_reasons=[]`) y compaction-window `status=ok` (`entries_total_raw=3`, `entries_total_compacted=3`, `window_raw_entries=3`, `missing_in_compacted_in_window=0`, `latest_present_ok=true`, `strict_fail_reasons=[]`); pipeline en verde. Evidencia en `docs/etl/sprints/AI-OPS-214/reports/sanction-procedural-official-review-packet-fix-queue-ai-ops-214-heartbeat-compaction-lane.md`.
- Slice AI-OPS-215 (garantías procedimentales/digest compacto strict sobre la paridad AI-OPS-214): se añade `scripts/report_sanction_procedural_official_review_packet_fix_queue_ai_ops_215_digest.py` (alias corto por límite de longitud de nombre de archivo) para consolidar en un contrato bajo ruido (`status`, `risk_level`, `risk_reasons`, `strict_fail_reasons`, `key_metrics`) la salida de `AI-OPS-214` (`ai_ops_214_heartbeat_compaction_window_latest.json`). `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_AI_OPS_215_DIGEST_IN` + `..._OUT`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-ai-ops-215-digest` + `parl-check-sanction-procedural-official-review-packet-fix-queue-ai-ops-215-digest`, integra el check en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 136` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_ai_ops_215_digest.py`. Corrida (`20260224T151207Z` y `20260224T151217Z`): digest `status=ok`, `risk_level=green`, `risk_reasons=[]`, `strict_fail_reasons=[]`, con primera corrida `entries_total_raw=4`/`entries_total_compacted=4`/`window_raw_entries=4` y replay integrado en pipeline `entries_total_raw=5`/`entries_total_compacted=5`/`window_raw_entries=5`; en ambos casos `missing_in_compacted_in_window=0` y `raw_window_coverage_pct=100.0`. Pipeline y tracker gate en verde (`mismatches=0`, `done_zero_real=0`). Evidencia en `docs/etl/sprints/AI-OPS-215/reports/sanction-procedural-official-review-packet-fix-queue-ai-ops-215-digest-lane.md`.
- Slice AI-OPS-216 (garantías procedimentales/continuidad heartbeat append-only sobre digest AI-OPS-215): se añade `scripts/report_sanction_procedural_official_review_packet_fix_queue_ai_ops_216_digest_heartbeat.py` (alias corto por límite de longitud de nombre de archivo) para registrar latidos deduplicados (`heartbeat_id`) sobre `ai_ops_215_digest_latest.json` con validación strict y salida reproducible (`history_size_before/after`, `appended`, `duplicate_detected`, `validation_errors`, `heartbeat.*`). `justfile` incorpora variables `SANCTION_PROCEDURAL_OFFICIAL_REVIEW_PACKET_FIX_QUEUE_AI_OPS_216_DIGEST_HEARTBEAT_DIGEST_JSON` + `..._PATH` + `..._OUT`, lanes `parl-report-sanction-procedural-official-review-packet-fix-queue-ai-ops-216-digest-heartbeat` + `parl-check-sanction-procedural-official-review-packet-fix-queue-ai-ops-216-digest-heartbeat`, integra el check en `parl-sanction-data-catalog-pipeline`, y `parl-test-sanction-data-catalog` sube a `Ran 138` con `tests/test_report_sanction_procedural_official_review_packet_fix_queue_ai_ops_216_digest_heartbeat.py`. Corrida (`20260224T152411Z`/`20260224T152416Z` + replay pipeline `20260224T152431Z`): heartbeat `status=ok`, `risk_level=green`, `strict_fail_count=0`, `validation_errors=[]`; check dedupe confirma `duplicate_detected=true` (`history_size_before=1`, `history_size_after=1`) y el replay integrado agrega una fila (`history_size_before=1`, `history_size_after=2`, `window_raw_entries=6`, `raw_window_coverage_pct=100.0`). Pipeline y tracker gate en verde (`mismatches=0`, `done_zero_real=0`). Evidencia en `docs/etl/sprints/AI-OPS-216/reports/sanction-procedural-official-review-packet-fix-queue-ai-ops-216-digest-heartbeat-lane.md`.

Pendiente (siguiente foco):
- PRIORIDAD ACTIVA: foco exclusivo en restricciones objetivas de libertad ciudadana (`Derechos`) hasta cumplir los umbrales de cobertura/gating definidos; el resto de lanes queda en espera salvo mantenimiento crítico.
- Horizonte de scraping activo (siguiente 7 días): completar la malla de evidencia faltante por derecho/ámbito y reforzar atribución causal con trazabilidad.
- Hoja de ruta operativa de scraping (Derechos, orden recomendado):
  1. Completar cobertura IRLC faltante por (`right_category_id`, `scope_id`) y persistir items faltantes en `liberty_restriction_assessment_items`.
  2. Consolidar trazabilidad de proporcionalidad en metodología + revisión documental con evidencia fechada.
  3. Cerrar contratos de responsabilidad directa/indirecta/delegada con cadena rol→acto→evidencia primaria.
  4. Aplicar limpieza de identidad/alias y deduplicación de edges para evitar atribución duplicada o ambigua.
  5. Materializar vistas de resumen (`*_by_fragment`, `accountability_edges`) antes de exportar snapshot.
  6. Ejecutar heartbeat + ventana + publish y registrar drift de release para `published`/GH-Pages/HF.

¿Qué datos sacar a continuación? 1) Cobertura completa IRLC + accountability por derecho/territorio 2) Evidencia de proporcionalidad cuando exista restricción 3) Cadena de responsabilidad indirecta y delegada en contexto territorial 4) Calidad de evidencia primaria (source_url/evidence_quote/evidence_date) en todos los edges nuevos.
- Cartera de scraping objetivo (iterable por lote y repetible):
- Fase A — Cierre de cobertura: `liberty_restriction_assessments` (faltantes por `right_category_id` + `scope_id`) + `liberty_restriction_assessment_items`.
- Fase B — Calidad de procedimiento: `liberty_proportionality_methodologies`/`liberty_proportionality_reviews` y validación de fecha/origen documental.
- Fase C — Responsabilidad y cadena de mando: `liberty_direct_accountability_scores`, `liberty_enforcement_methodologies`, `liberty_enforcement_observations`, `liberty_indirect_methodologies`, `liberty_indirect_responsibility_edges`, `liberty_delegated_enforcement_links`.
- Fase D — Limpieza/reproducibilidad: normalizar claves/aliases nuevos, deduplicar edges ambiguos y materializar resumenes en `*_by_fragment`/`accountability_edges` antes de export.

- Comando base (idéntico a cada corrida para reproducibilidad):
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=2026-03-05 just parl-liberty-restrictions-pipeline`
- Cadencia de controles posterior (en orden):
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=2026-03-05 just parl-check-liberty-restrictions-status`
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=2026-03-05 just parl-check-liberty-focus-gate`
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=2026-03-05 just parl-report-liberty-restrictions-status-heartbeat`
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=2026-03-05 just parl-check-liberty-restrictions-status-heartbeat-window`
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=2026-03-05 just parl-export-liberty-restrictions-snapshot`
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=2026-03-05 just parl-publish-liberty-atlas-artifacts`
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=2026-03-05 just parl-report-liberty-atlas-release-heartbeat`
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=2026-03-05 just parl-check-liberty-atlas-release-heartbeat-window`

- Regla de continuidad entre ciclos:
- Cualquier corrida que baje `status=degraded` en `rights_with_data`, `source_dual_coverage`, `scope_representativity` o `accountability_primary_evidence` debe ir a una mini-acción visible del backlog (sin abrir nuevas dependencias externas) antes de la siguiente corrida de foco.
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=2026-03-05 just parl-check-liberty-focus-gate`
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=2026-03-05 just parl-report-liberty-restrictions-status-heartbeat`
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=2026-03-05 just etl-publish-hf`
- Normativa/Accountability: ampliar el slice ya abierto (`ley -> fragmentos` + lineage seed `deroga/modifica/desarrolla`) a cobertura BOE completa por `artículo/disposición/anexo` y lineage histórico por versión/fecha (sin depender de semilla cerrada).
- Normativa/Accountability: evolucionar la cadena por rol (`propose`, `approve`, `delegate`, `enforce`) desde hints de semilla a edges con evidencia primaria fechada (`source_url`, cita legal, `evidence_date`, `evidence_quote`).
- Normativa/Accountability: escalar lane ya abierto de organismos delegados (p.ej. DGT/AEAT/ITSS) desde seed a evidencia primaria fechada y resolución persona/cargo: `norma habilitante -> órgano -> cargo designado -> acto de enforcement`.
- Agro/Impacto regulatorio: definir `agri_burden_score` auditable por norma (coste cumplimiento, carga administrativa, riesgo sancionador, cobertura territorial) con pesos explícitos.
- Agro/Impacto regulatorio: publicar `top-N` normas más gravosas para agricultores/ganaderos con ficha por norma y enlaces a BOE/EUR-Lex + cambios de alivio posteriores.
- Agro/Accountability: para cada norma del `top-N`, publicar cadena de responsabilidad por rol (`propose/approve/delegate/enforce`) a nivel de fragmento.
- Vivienda/Cuellos de botella: mapear de forma reproducible `planeamiento -> urbanización -> licencia -> obra` y extraer dónde se concentra el retraso por norma/administración/territorio.
- Vivienda/Oferta nueva: medir impacto de regulación de alquiler (Ley 12/2023 + desarrollos CCAA) sobre promoción nueva (`visados/inicios/terminadas`) con control básico de confusores.
- Vivienda/Accountability: publicar `top_normas_cuello_botella_vivienda` (piloto top-N) con metodología explícita y chain-of-responsibility por fragmento (`propose/approve/delegate/enforce`).
- Sanidad/Gasto: construir cuadro comparable `personal asistencial vs gasto externo/capital` por CCAA y programa (serie temporal, no foto única) para detectar sustituciones de prioridad.
- Sanidad/Contratación: priorizar lane de expedientes sanitarios de alto importe (equipos/obras/IT/consultoría/conciertos) con KPI de modificados, sobrecostes y retrasos por órgano de contratación.
- Sanidad/Accountability: publicar cadena de responsabilidad por decisión de gasto sanitario (`propose/approve/execute/audit`) con trazabilidad `presupuesto -> cargo designado -> expediente -> pago -> resultado asistencial`.
- Ciudadanía/Sanciones: escalar `top_normas_sancion_ciudadana` desde piloto a series oficiales reales por fuente/territorio y completar `incidencia por 1.000 habitantes` con denominadores poblacionales auditables.
- Ciudadanía/Dossiers: pasar de `norm_dossiers` piloto (top-5) a cobertura `top-N` con `perfil afectado`, series temporales y drill-down legal/territorial completo.
- Ciudadanía/Normativa base: ampliar el catálogo v1 ya publicado en DB a cobertura territorial (Estado + municipal), con fragmentación completa por norma y vía de recurso por territorio.
- Ciudadanía/Datos: pasar de catálogo semilla a observaciones reales por fuente (`sanction_volume_observations`) con series por periodo/territorio y control de calidad por métrica.
- Ciudadanía/Semilla v1: versionar a `v2` la lista cerrada inicial (manteniendo compatibilidad) con cobertura ampliada y reglas explícitas de alta/baja por BOE ID.
- Ciudadanía/Municipal: completar normalización del piloto `20 ciudades` (hoy `3/20`) a nivel `articulo/conducta/rango_importe/organo/recurso` para hacer comparable la capa local.
- Ciudadanía/Tipologías: completar mappings municipales y elevar cobertura de `norma_fragmento_id` a nivel operativo para explicar tipologías con evidencia legal comparable.
- Ciudadanía/Accountability: extender la cadena sancionadora desde `norma -> fragmento -> rol` a nivel expediente (`resolución -> cobro -> recurso/resultado`) con evidencia fechada por rol.
- Ciudadanía/Garantías: poblar `sanction_procedural_metrics` con datos de TEAR/TEAC/contencioso/defensores y publicar serie de `% recursos estimados`, anulaciones por forma y plazos.
- Ciudadanía/Coste de vida regulado: abrir lane de energía doméstica (luz/gas) separando componente regulado vs mercado y trazando cambios normativos a impacto en factura.
- Ciudadanía/Fiscalidad local: abrir comparador de ordenanzas e impacto de IBI/IVTM/basura/plusvalía con cadena de decisión municipal y trazabilidad por municipio.
- Ciudadanía/Consumo masivo: mapear fricción regulatoria en banca minorista y telecom (cobros/reclamaciones) con métricas comparables y drill-down normativo.
- Ciudadanía/Agua: abrir comparador regulatorio de tarifas/cánones de agua y saneamiento con impacto mensual por hogar y trazabilidad por municipio.
- Ciudadanía/Transporte: modelar reglas de tarifas y bonificaciones en transporte público para estimar coste neto por perfil y territorio.
- Ciudadanía/Farmacia: mapear copago y financiación de medicamentos con impacto de bolsillo por perfil (renta/cronicidad/pensionista).
- Ciudadanía/Educación infantil: comparar precios públicos y ayudas (guardería/comedor/servicios asociados) con elegibilidad y coste neto por hogar.
- Ciudadanía/Burocracia digital: catalogar obligaciones electrónicas y sanciones/recargos por incumplimiento para medir fricción administrativa real.
- Ciudadanía/Seguros obligatorios: mapear obligaciones de aseguramiento de alta incidencia y su coste recurrente mínimo por hogar.
- Derechos/IRLC: escalar IRLC v1 desde seed sancionador a cobertura multi-boletín (Estado+CCAA+municipal) con refresco reproducible por snapshot.
- Derechos/Mapa: mantener cobertura completa de categorías por derecho y escalar drill-down territorial multi-fuente (Estado+CCAA+municipal) con refresh reproducible.
- Derechos/Proporcionalidad: escalar el contrato ya operativo (seed+gate) hacia ingesta continua AIR/ex-post para cubrir eficacia observada y `sunset/revisión` con evidencia primaria fuera del piloto.
- Derechos/Arbitrariedad territorial: escalar el lane operativo ya abierto (métricas por `fragment_id`: sanciones, anulaciones y plazos por territorio) a ingesta periódica real CCAA/municipal y cobertura fuera del piloto semilla.
- Derechos/Censo total: construir inventario integral Estado+CCAA+municipal de normas y fragmentos con potencial restricción de libertad (sin muestreo parcial).
- Derechos/Responsabilidad directa: extender la cobertura directa ya iniciada (`propose/approve/enforce`) con actos `firmar/votar/resolver` y evidencia primaria fechada multi-fuente, sobre base de gate ya activo para evidencia primaria directa (AI-OPS-136), validando ventana temporal de cargo por persona.
- Derechos/Responsabilidad indirecta: escalar el contrato persona/cargo+ventana ya activado en AI-OPS-137 desde seed a cobertura multi-fuente real (nombramientos/resoluciones oficiales), manteniendo filtros de atribución (`delegate/appoint/instruct/design`) y robusteciendo causalidad con evidencia primaria fechada.
- Derechos/Scoring personal: escalar el contrato ya abierto en AI-OPS-138 y endurecido en AI-OPS-139/140/141/142/143/144/145/146/147/148/149/150/151/152/153/154 (sin sesgo `top_n`, con gate explícito de resolución, colas accionables `manual->official` y de remediación de gaps `official_*` para evidencia/source-record, loop reproducible review/apply por CSV, guardrail anti-retarget manual sobre alias `official_*`, control de procedencia manual vs `official_*`, evidencia obligatoria en alias oficiales, cuota mínima configurable de alias `official_*`, trazabilidad mínima a `source_record_pk`, autoresolución en apply, prefill temprano, separación explícita de backlog accionable vs placeholder y observabilidad continua con heartbeat+ventana strict de cola accionable) desde seed hacia identidad real multi-fuente de persona/cargo y mayor cobertura territorial fuera del piloto.
- Derechos/Cobertura: escalar la rutina periódica ya operativa (heartbeat + window strict sobre KPIs) hacia cobertura representativa fuera de seed (State+CCAA+municipal), manteniendo los umbrales ya activos de representatividad y doble cobertura por fuente/territorio (AI-OPS-132/133) y el quality-gate de evidencia primaria en accountability ahora en modo estricto por defecto (AI-OPS-134/135).
- Congreso: el linking voto -> iniciativa está cubierto vía fallback `derived` cuando no hay match oficial; el KPI clave ahora es subir la **cobertura oficial** (`events_with_official_initiative_link_pct`) si decidimos invertir en eso (p.ej. incorporar tipos faltantes como PNL/mociones).
- Reemplazar el KPI “tema enlazado” por un KPI real de clasificación a `topic_id` (no confundir “hay texto” con “hay tema”).
- Consolidar `backfill-topic-analytics` como parte del loop E2E (votos -> evidencia -> posiciones) y visibilizarlo en `/explorer-temas`.
- Intervenciones (says): subir `declared_evidence_with_signal_pct` con `just parl-backfill-declared-stance` (stance regex v2, conservador) y mantener `topic_evidence_reviews` como cola de casos ambiguos para auditoría humana.
- Materializar `computed_method=combined` (`just parl-backfill-combined-positions`) y usarlo como vista por defecto en producto para evitar mezclar “says/does” en tiempo real.
- Siguiente bloque técnico: drill-down de coherencia por `topic_set/topic/scope` para priorizar revisión donde la incoherencia sea material.
- Mantener cierre operativo del loop de revisión de fila `103` ya integrado al pipeline: conservar en verde `parl-check-liberty-person-identity-official-upgrade-review-queue-actionable-empty` y la ventana `parl-check-liberty-person-identity-official-upgrade-review-queue-actionable-heartbeat-window`; reabrir `review-decision` solo cuando `actionable_rows_total` vuelva a ser `>=1`.
- Operativizar rutina post-snapshot: `just etl-publish-hf` y verificación de `latest.json` en el dataset público.

## TODO operativo: convergencia a ingesta real robusta (2026-02-27 -> 2026-05-29)

Referencias canónicas:
- Operación y estado real por fila: `docs/etl/e2e-scrape-load-tracker.md`
- Bloqueos de acceso público: `docs/etl/name-and-shame-access-blockers.md`

Baseline (2026-02-26):
- `PARTIAL=25`
- `TODO=27`
- `DONE=38`

### Fase 0: hardening transversal (2026-02-27 -> 2026-03-06)
- [ ] Consolidar contrato único de ingesta real por lane: `strict-network`, `records_loaded > 0`, upsert idempotente, `PRAGMA foreign_key_check` limpio.
- [ ] Asegurar gates CI por lane con KPIs mínimos de frescura/cobertura/calidad.
- [ ] Mantener semillas solo como bootstrap (no como estado final de producción).
- [ ] Cerrar corrida de verificación: `just etl-tracker-gate`.

### Fase 1: foco exclusivo Derechos (2026-03-07 -> 2026-04-03)
- [ ] Escalar `Derechos` desde seed a ingesta continua real (Estado + CCAA + municipal + jurisprudencia).
- [ ] Completar `ley -> fragmentos` y lineage histórico multi-versión/fecha en BOE.
- [ ] Escalar cadena de responsabilidad por rol (`propose/approve/delegate/enforce`) con evidencia primaria fechada.
- [ ] Escalar lane de organismos delegados (`norma -> organo -> cargo -> acto`) con resolución persona/cargo.
- [ ] Cerrar rutina semanal en verde:
  - `DB_PATH=<db> SNAPSHOT_DATE=<date> just parl-liberty-restrictions-pipeline`
  - `DB_PATH=<db> just parl-check-liberty-focus-gate`

### Fase 2: bloqueos críticos (paralelo; max 1 retry estricto por sprint sin nuevo lever)
- [ ] Mantener probes reproducibles para `parlamento_galicia_deputados` (403).
- [ ] Mantener probes reproducibles para `congreso_votaciones` (403).
- [ ] Resolver o documentar bloqueo de `bde_series_api` (DNS).
- [ ] Resolver o documentar bloqueo de `aemet_opendata_series` (contract/token).
- [ ] En cada caso: o recuperación real, o evidencia append-only en `name-and-shame` + tracker (sin fake DONE).

### Fase 3: cierre de gaps principales fuera de Derechos (2026-04-04 -> 2026-05-29)
- [ ] JEC: scraper y normalización de convocatorias/estado electoral.
- [ ] Normativa autonómica: BOCM/DOGC/BOJA con dedupe por versión y trazabilidad.
- [ ] Presupuesto + ejecución autonómica: conectores + crosswalk reproducible.
- [ ] Ciudadanía sancionadora: pasar de piloto a series oficiales recurrentes (DGT/AEAT/TGSS/Interior + municipal).
- [ ] Garantías procedimentales: poblar con datos reales TEAR/TEAC/contencioso/defensores.
- [ ] Abrir/avanzar lanes de mayor impacto social pendientes (vivienda, sanidad, energía, fiscalidad/consumo) con vertical slices entregables.

### Metas de salida (programa)
- [ ] Hito 2026-04-03: `PARTIAL <= 18` y sin crecimiento de `TODO`.
- [ ] Hito 2026-05-29: `PARTIAL <= 8` y `TODO <= 15`.
- [ ] Mantener `DONE` solo con evidencia real reproducible de red o bloqueo documentado.
- [ ] Publicar snapshot verificable por ciclo con `just etl-publish-hf` + comprobación de `latest.json`.

### Reglas de ejecución
- [ ] Respetar política anti-loop: `>=70%` trabajo controlable y `<=30%` unblock/probe por sprint.
- [ ] Entregar al menos un delta visible por sprint (schema/data/UI/artifact).
- [ ] No repetir probe sin nuevo lever explícito.

## Sprint operativo recomendado (3 bloques de ejecución)

Sprint 1 — 2026-02-26 -> 2026-03-03 — estabilizar cobertura básica de `Derechos` (Fase A-B):
- Entregable: malla `liberty_restriction_assessments` + `liberty_restriction_assessment_items` completa por vacío de derecho/ámbito; proporcionalidad con metodología y evidencia temporal valida.
- DoD: `parl-liberty-restrictions-pipeline` en verde + `rights_with_data_gate_passed=true` en status.
- Evidencia:
  - `docs/etl/e2e-scrape-load-tracker.md` actualizada al mismo ciclo.
  - `docs/etl/runs/*` del día ejecutado con reporte de status y heartbeat.

Sprint 2 — 2026-03-04 -> 2026-03-10 — cerrar trazabilidad de responsabilidad (Fase C):
- Entregable: expansión controlada de responsabilidad directa/indirecta/delegada con fuentes primarias (`source_url`, `evidence_date`, `evidence_quote`) en edges.
- DoD: gates de dual-coverage/scope representativity sin degradación y sin saltos duplicados en cadena causal.
- Evidencia:
  - `docs/etl/sprints/AI-OPS-13x/reports/*` del slice activado.
  - `report_liberty_restrictions_status_heartbeat_window.py` sin reintentos fantasma en ventana `last N`.

Sprint 3 — 2026-03-11 -> 2026-03-17 — limpieza, resumen y publicación (Fase D + release):
- Entregable: deduplicación de edges ambiguos, materialización de vistas `*_by_fragment`/`accountability_edges` y snapshot exportado.
- DoD: release heartbeat window `ok` en los 2 checks principales y `etl-publish-hf` exitoso con `latest.json` coherente.
- Evidencia:
  - `docs/etl/runs/liberty_restrictions_snapshot_changelog.jsonl` actualizado.
  - `etl/data/published/liberty-restrictions-atlas-release-latest.json` y `scripts/report_liberty_atlas_release_heartbeat.py` con estado `ok`.

## Checklist operativo diario (hoy -> 7 días)

- Día 1 (2026-03-05): ejecutar secuencia base completa de `Foco operativo actual`; validar `parl-liberty-restrictions-pipeline`.
- Día 2 (2026-02-27): cerrar faltantes de `liberty_restriction_assessments` + `assessment_items`; validar `parl-check-liberty-restrictions-status`.
- Día 3 (2026-02-28): elevar calidad de proporcionalidad (`methodologies`/`reviews`); validar evidencia documental.
- Día 4 (2026-03-01): extender responsabilidad directa/indirecta/delegada (fase C); validar doble cobertura y representatividad.
- Día 5 (2026-03-02): limpieza de aliases/edges ambiguos y normalización de llaves para `*_by_fragment` y `accountability_edges`.
- Día 6 (2026-03-03): snapshot + release heartbeat y window; registrar drift en `name-and-shame` si aplica.
- Día 7 (2026-03-04): publicar HF (`etl-publish-hf`) y validar `latest.json`; solo avanzar a nuevos slices si `focus-gate` y tracker quedan en verde.

## Foco táctico próximo (7 días corridos)

Línea base:
- Mantener `Derechos` como único bloque de expansión funcional hasta que `focus_gate` permanezca verde dos ciclos consecutivos.

Semana 1:
- Ejecutar los comandos base de `Foco operativo actual` sin variaciones.
- Cerrar backlog de mini-acciones con prioridad alta: continuidad de cadena IRLC + dual-coverage + evidencia primaria.
- Validar que `snapshot_date` avance y quede reflejado en:
  - `docs/etl/sprints/AI-OPS-12x/*/reports/*` del ciclo actual.
  - `docs/etl/e2e-scrape-load-tracker.md`.

Semana 2:
- Avanzar Fase A-D de scraping con lotes de tamaño acotado y trazabilidad por `source_record_id`.
- Ejecutar heartbeat-window en modo estricto para `status` y `release`.
- Publicar/validar `latest.json` en HF en cada snapshot estable.

Semana 3:
- Resolver o aislar bloqueos externos repetidos (`bde_series_api`, `aemet_opendata_series`, PLACSP details).
- Si persisten bloqueos, registrar evidencia y pasar a siguiente slice interna sin abrir nuevas dependencias.

Criterio de avance de fase:
- No abrir nuevas fases si queda un gate de `focus_gate` en degradado o `done_zero_real>0` en el tracker.

## Foco operativo actual (2026-03-05): ejecución repetible y bloqueos confirmados

Objetivo del bloque activo:
- Mantener `Derechos` como único flujo de expansión funcional hasta cumplir el gate de cobertura y calidad.
- No cerrar ni marcar como `DONE` ningún row sin evidencia reproducible o bloqueo documentado.

Estado observado en el último ciclo:
- ✅ Base de atlas/coverage y publicación local de artefactos: ejecución funcional (`export_liberty_restrictions_snapshot.py`, `publish_liberty_atlas_artifacts.py`).
- ✅ Heartbeat de cobertura y continuidad: ejecución funcional con `report_liberty_restrictions_status_heartbeat.py` y `report_liberty_restrictions_status_heartbeat_window.py`.
- ✅ AI-OPS-218: continuidad de cobertura y snapshot cerrada (`status=ok`) para `SNAPSHOT_DATE=2026-03-05`, incluyendo continuidad de changelog y artefactos base.
- ✅ AI-OPS-219 ejecutado: contract-path correcto confirmado en `AI-OPS-219/evidence/liberty_atlas_release_heartbeat_20260226T092333Z.json` (`status=degraded`, `published_release_ok=true`, `hf_unavailable=true`, `strict_fail_reasons=[]`).
- ⚠️ AI-OPS-219 residual: la ventana strict de release heartbeat sigue `failed` en `AI-OPS-219/evidence/liberty_atlas_release_heartbeat_window_20260226T092333Z.json` por histórico de `failed/degraded/drift/hf_unavailable`; no se han ajustado umbrales en esta iteración.
- ⚠️ Bloqueos externos fuera de ciclo principal siguen vigentes para `parlamento_galicia_deputados` y `congreso_votaciones` (403); registrarlos en nombre y pasar sólo con evidencia.
- ✅ Tracker de e2e sin desalineaciones en la corrida consultada (`mismatches: 0`, `done_zero_real: 0`).

Secuencia repetible diaria/semanal (en este orden):
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=<YYYY-MM-DD> just parl-liberty-restrictions-pipeline`
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=<YYYY-MM-DD> just parl-check-liberty-restrictions-status`
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=<YYYY-MM-DD> just parl-check-liberty-focus-gate`
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=<YYYY-MM-DD> just parl-report-liberty-restrictions-status-heartbeat`
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=<YYYY-MM-DD> just parl-check-liberty-restrictions-status-heartbeat-window`
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=<YYYY-MM-DD> just parl-report-liberty-atlas-release-heartbeat --allow-hf-unavailable`
- `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=<YYYY-MM-DD> just parl-check-liberty-atlas-release-heartbeat-window`
- `DB_PATH=etl/data/staging/politicos-es.db just etl-publish-hf`

Mini-acción prioritaria (AI-OPS-219):
- Cierre ya ejecutado (estado residual):
  - `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=2026-03-05 just parl-report-liberty-atlas-release-heartbeat --allow-hf-unavailable`
  - `DB_PATH=etl/data/staging/politicos-es.db SNAPSHOT_DATE=2026-03-05 just parl-check-liberty-atlas-release-heartbeat-window`

Próximo micro-objetivo:
- Mantener `Derechos` estable hasta que se decida un nuevo `window` policy para `AI-OPS-219` o se limpie historial histórico de degradación con comando de continuidad explícita (sin nuevos cambios de fuente).

Regla de continuación (si hay fallo):
- Si cualquier gate de derechos cae de `ok` a `degraded`, abrir mini-acción en `docs/etl/e2e-scrape-load-tracker.md` en el mismo día; sin eso, no avanzar a nuevas adquisiciones externas.
- Si `placsp`/`aemet_opendata_series`/`bde_series_api` vuelven a fallar con el mismo patrón, registrar evidencia append-only en `docs/etl/name-and-shame-access-blockers.md` y pasar.
